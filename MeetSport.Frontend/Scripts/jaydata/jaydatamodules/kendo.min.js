// JayData 1.5.0 CTP
// Dual licensed under MIT and GPL v2
// Copyright JayStack Technologies (http://jaydata.org/licensing)
//
// JayData is a standards-based, cross-platform Javascript library and a set of
// practices to access and manipulate data from various online and offline sources.
//
// Credits:
//     Hajnalka Battancs, Dániel József, János Roden, László Horváth, Péter Nochta
//     Péter Zentai, Róbert Bónay, Szabolcs Czinege, Viktor Borza, Viktor Lázár,
//     Zoltán Gyebrovszki, Gábor Dolla
//
// More info: http://jaydata.org
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.$data=e()}}(function(){return function e(t,n,a){function r(i,s){if(!n[i]){if(!t[i]){var d="function"==typeof require&&require;if(!s&&d)return d(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return r(n?n:e)},u,u.exports,e,t,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(e,t,n){(function(a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("jaydata/core"),i=r(o),s="undefined"!=typeof window?window.jQuery:"undefined"!=typeof a?a.jQuery:null,d=r(s),l="undefined"!=typeof window?window.kendo:"undefined"!=typeof a?a.kendo:null,u=r(l);!function(e,t){var n=e.Entity.inheritedTypeProcessor;e.kendo={},e.kendo.BaseModelType=u["default"].data.Model.define({init:function(e){u["default"].data.Model.fn.init.call(this,e)}}),e.kendo.attachMode=!0,e.EntityAttachMode&&(e.kendo.attachMode=e.EntityAttachMode.KeepChanges);var a={"$data.Blob":"string","$data.String":"string","$data.Boolean":"boolean","$data.Integer":"number","$data.Number":"number","$data.Date":"date","$data.DateTimeOffset":"date","$data.Time":"string","$data.Day":"string","$data.Duration":"string","$data.Byte":"number","$data.SByte":"number","$data.Int16":"number","$data.Int32":"number","$data.Int64":"number","$data.Decimal":"string","$data.Float":"number"};e.Entity.inheritedTypeProcessor=function(t){function r(e,t){return a[e]||"object"}function o(n){function a(e,t){return"$data.Boolean"===e?!0:t.required!==!0}function o(e,t){return"$data.Boolean"===e?!1:t.required||"nullable"in t?!t.nullable:!1}function i(e,t){}var s=t.memberDefinitions,d={};s.getPublicMappedProperties().forEach(function(t){var n=e.Container.resolveName(t.type);d[t.name]={type:r(n,t),nullable:a(n,t),defaultValue:t.defaultValue,editable:!t.computed,validation:{required:o(n,t)}}});var l={fields:d,init:function(a){var r=(n&&n.owningContextType||void 0,[]);n&&n.owningContextType&&(r=n.owningContextType.memberDefinitions.getPublicMappedProperties().filter(function(t){return e.Container.resolveType(t.type)===e.EntitySet}).map(function(t){return e.Container.resolveType(t.elementType)}));var o={entityBuilder:function(t,n){n.forEach(function(n){if(n.key!==!0&&(n.required===!0||n.nullable===!1)){var s=e.Container.resolveType(n.type);if(s.isAssignableTo&&s.isAssignableTo(e.Entity)&&-1===r.indexOf(s)){var d;a&&(d=a[n.name]),t[n.name]=new s(d,o)}else i(t,n)}})}},s=a instanceof t?a:new t(a,o),d=s.initData,l={};for(var f in d){var c=t.getMemberDefinition(f),p=d[f];if(p instanceof e.Entity){var y=p.asKendoObservable();l[f]=y}else if(c&&e.Container.resolveType(c.type)===Array){var v=e.Container.resolveType(c.elementType),h=v;v.asKendoModel&&(h=v.asKendoModel());var m=new u["default"].data.ObservableArray(d[f],h);l[f]=m,l[f].bind("change",function(e){s.changeFromKendo=!0,this.parent().dirty=!0,s[c.name]=this.toJSON(),delete s.changeFromKendo})}else c&&e.Container.resolveType(c.type)===e.Blob?l[f]=e.Blob.toBase64(p):l[f]=p}for(var g=t.memberDefinitions.getPublicMappedProperties().filter(function(t){return e.Container.resolveType(t.dataType)===Array&&!e.Container.resolveType(t.elementType).asKendoModel}),f=0;f<g.length;f++){var b=g[f];(null===d[b.name]||void 0===d[b.name])&&(l[b.name]=new u["default"].data.ObservableArray([],e.Container.resolveType(b.elementType)),l[b.name].bind("change",function(e){s.changeFromKendo=!0,this.parent().dirty=!0,s[b.name]=this.toJSON(),delete s.changeFromKendo}))}var T=this;this.innerInstance=function(){return s},e.kendo.BaseModelType.fn.init.call(this,l),s.propertyChanged.attach(function(t,n){var a=this,r=n.newValue,o=s.getType().getMemberDefinition(n.propertyName);if(a.changeFromKendo){if(e.Container.resolveType(o.type)===e.Blob){var i=e.Blob.toString(r);r=e.Container.convertTo(atob(i),e.Blob),s.changeFromJay=!0,s.initData[o.name]=r,delete s.changeFromJay}}else r=r&&r.asKendoObservable?r.asKendoObservable():r,s.changeFromJay=!0,e.Container.resolveType(o.type)===e.Blob&&r&&(r=e.Blob.toBase64(r)),T.set(n.propertyName,r),o.computed&&T[n.propertyName]!==r&&(T[n.propertyName]=r),delete s.changeFromJay}),this.bind("set",function(t){var a=t.field,r=a.split(".");if(s.changeFromKendo=!0,1==r.length){var o=t.value;s.changeFromJay||(o=o.innerInstance?o.innerInstance():o,s[a]=o,n&&n.autoSave&&s.save())}else{var i=s[r[0]];i instanceof e.Entity&&(s[r[0]]=i)}delete s.changeFromKendo}),n&&n.newInstanceCallback&&n.newInstanceCallback(s)},save:function(){return this.innerInstance().save()},remove:function(){return this.innerInstance().remove()}},f=s.getKeyProperties();switch(f.length){case 0:break;case 1:l.id=f[0].name;break;default:console.warn("entity with multiple keys not supported")}e.Trace.log("md",l);var c=u["default"].data.Model.define(e.kendo.BaseModelType,l);return c}function i(e){var n=e||t;return n.kendoModelType||(n.kendoModelType=o(e))}function s(e,n){var a=t.asKendoModel(n);return new a(e)}function d(e){return e||""}function l(e,t){if(t.provider){var n=d(t.databaseName)+d(t.tableName)+d(t.url)+d(t.apiUrl)+d(t.oDataServiceHost),a={provider:t.provider,databaseName:t.databaseName,tableName:t.tableName,dataSource:t.url,apiUrl:t.apiUrl,oDataServiceHost:t.oDataServiceHost};return Object.keys(a).forEach(function(e){delete t[e]}),e.setStore(n,a),n}}t.memberDefinitions;t.asKendoModel=i,t.prototype.asKendoObservable=function(e){var t=s(this,e);return t},t.asKendoDataSource=function(n,a,r){n=n||{};var o=a||{},i=l(t,n)||r,s=e.ItemStore._getStoreAlias(t,i),d=e.ItemStore._getContextPromise(s,t),u=d.getEntitySetFromElementType(t);return u.asKendoDataSource(n,o)},n&&n(t)},e.Queryable.addMember("asKendoColumns",function(n){function r(e){e=Array.isArray(e)?e:[e];var t=this.concat(e);return s(t)}function o(e){e=Array.isArray(e)?e:[e];var t=e.concat(this);return s(t)}function i(e,n){var a=this.filter(function(t){return t.field==e})[0];return t.extend(a,n),this}function s(e){return e.prepend=o,e.append=r,e.setColumn=i,e}var d=[];n=n||{};var l=n.$showComplexFields===!0;return delete n.$showComplexFields,this.defaultType.memberDefinitions.getPublicMappedProperties().forEach(function(r){if(l||a[e.Container.resolveName(r.type)]){var o=n[r.name]||{},i={field:r.name};t.extend(i,o),d.push(i)}}),s(d)}),e.EntityContext.addProperty("EntitySetNames",function(){var e=this;return Object.keys(e._entitySetReferences).map(function(t){return e._entitySetReferences[t].tableName})}),e.Queryable.addMember("asKendoModel",function(e){return e.owningContextType=e.owningContextType||this.entityContext.getType(),this.defaultType.asKendoModel(e)}),e.Queryable.addMember("asKendoRemoteTransportClass",function(t){var n=this,a=n.entityContext,r=u["default"].data.RemoteTransport.extend({init:function(){this.items=[]},read:function(t){var a=n;a.entityContext.onReady().then(function(){var n=a,r=(a.entityContext.storageProvider,a.entityContext.storageProvider.supportedSetOperations.withInlineCount),o=!r&&a.entityContext.storageProvider.supportedSetOperations.length;if(r&&(n=n.withInlineCount()),t.data.filter){var i="",s={};t.data.filter.filters.forEach(function(n,a){switch(a>0&&(i+="or"==t.data.filter.logic?" || ":" && "),n.operator){case"eq":i+="it."+n.field,i+=" == this."+n.field;break;case"neq":i+="it."+n.field,i+=" != this."+n.field;break;case"startswith":i+="it."+n.field,i+=".startsWith(this."+n.field+")";break;case"contains":i+="it."+n.field,i+=".contains(this."+n.field+")";break;case"doesnotcontain":i+="!",i+="it."+n.field,i+=".contains(this."+n.field+")";break;case"endswith":i+="it."+n.field,i+=".endsWith(this."+n.field+")";break;case"gte":i+="it."+n.field,i+=" >= this."+n.field;break;case"gt":i+="it."+n.field,i+=" > this."+n.field;break;case"lte":i+="it."+n.field,i+=" <= this."+n.field;break;case"lt":i+="it."+n.field,i+=" < this."+n.field;break;default:e.Trace.log("unknown operator",n.operator)}s[n.field]=n.value}),n=n.filter(i,s)}var l=n;t.data.sort&&t.data.sort.forEach(function(e){n=n.order(("desc"==e.dir?"-":"")+e.field)}),t.data.skip&&(n=n.skip(t.data.skip)),t.data.take&&(n=n.take(t.data.take));var u=[];u.push(n.toArray()),o?u.push(l.length()):r||u.push(l.toArray()),e.Trace.log(u),d["default"].when.apply(this,u).then(function(n,a){var i=n.map(function(t){var n=(t instanceof e.Entity?t.initData:t,t.asKendoObservable());return n}),s={data:i,total:r?n.totalCount:o?a:a.length};e.Trace.log(s),t.success(s)}).fail(function(){console.log("error in create"),t.error({},arguments)})})},create:function(e,t){var r=n;r.entityContext.onReady().then(function(){if(t.length>1){var n=[];t.forEach(function(e){n.push(e.innerInstance())}),a.addMany(n),a.saveChanges().then(function(){var t=[];n.forEach(function(e){t.push(e.initData)}),e.success()}).fail(function(){console.log("error in create"),e.error({},arguments),a.stateManager.reset()})}else t[0].innerInstance().save(a.storeToken).then(function(){e.success()}).fail(function(){console.log("error in create"),e.error({},arguments)})})},update:function(t,r){var o=n;o.entityContext.onReady().then(function(){if(r.length>1){var n=r.map(function(e){return e.innerInstance()});n.forEach(function(t){a.attach(t,e.kendo.attachMode)}),a.saveChanges().then(function(){t.success()}).fail(function(){a.stateManager.reset(),t.error({},arguments)})}else r[0].innerInstance().save(void 0,void 0,e.kendo.attachMode).then(function(e){t.success()}).fail(function(){t.error({},arguments)})})},destroy:function(e,t){var r=n;r.entityContext.onReady().then(function(){t.length>1?(t.forEach(function(e){a.remove(e.innerInstance())}),a.saveChanges().then(function(){e.success({data:e.data})}).fail(function(){a.stateManager.reset(),e.error({},"error",e.data)})):t[0].innerInstance().remove().then(function(){e.success({data:e.data})}).fail(function(){a.stateManager.reset(),e.error({},"error",e.data)})})},setup:function(){e.Trace.log("setup"),e.Trace.log(arguments)}});return r});var r=u["default"].data.DataSource.extend({init:function(){u["default"].data.DataSource.fn.init.apply(this,arguments)},createItem:function(e){var t=this.options.schema.model;return new t(e)},_promise:function(e,n,a){var r=this,o=t.extend,i=r.transport;return t.Deferred(function(t){i[a].call(i,o({success:function(e){t.resolve({response:e,models:n,type:a})},error:function(e,n,a){t.reject(e),r.error(e,n,a)}},e),n)}).promise()}});e.kendo=e.kendo||{},e.kendo.defaultPageSize=25,e.Queryable.addMember("asKendoDataSource",function(t,n){var a=this;n=n||{};var o=a.asKendoModel(n);t=t||{},t.serverPaging=void 0===t.serverPaging?!0:t.serverPaging,t.serverFiltering=void 0===t.serverFiltering?!0:t.serverFiltering,t.serverSorting=void 0===t.serverSorting?!0:t.serverSorting,t.pageSize=void 0===t.pageSize?e.kendo.defaultPageSize:t.pageSize;var i=a.asKendoRemoteTransportClass(o);return t.transport=new i,t.schema={model:o,data:"data",total:"total"},new r(t)}),u["default"].data.binders.submit=u["default"].data.Binder.extend({init:function(e,n,a){u["default"].data.Binder.fn.init.call(this,e,n,a),t(e).bind("submit",function(){var e=n.submit.source,t=e[n.submit.path];return"function"==typeof t?(t.apply(e,arguments),!1):void 0})},refresh:function(){}})}(i["default"],d["default"]),n["default"]=i["default"],t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"jaydata/core":"jaydata/core"}]},{},[1])(1)});
//# sourceMappingURL=kendo.min.js.map
