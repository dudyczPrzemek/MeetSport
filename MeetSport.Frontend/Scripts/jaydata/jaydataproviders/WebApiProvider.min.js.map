{"version":3,"sources":["WebApiProvider.js","src/Types/StorageProviders/WebApi/WebApiConverter.js","src/Types/StorageProviders/WebApi/WebApiProvider.js","src/Types/StorageProviders/WebApi/index.js"],"names":["interopDefine","define","amd","deps","callback","f","exports","module","g","window","global","self","this","$data","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","_core","_core2","WebApiConverter","fromDb","$data.Byte","Container","proxyConverter","$data.SByte","$data.Decimal","$data.Float","$data.Int16","$data.Int64","$data.Integer","$data.Int32","$data.Number","$data.Date","dbData","Date","substring","parseInt","substr","indexOf","match","$data.DateTimeOffset","$data.Time","$data.String","$data.Boolean","$data.Blob","v","convertTo","atob","$data.Object","undefined","Object","JSON","parse","$data.Array","Array","$data.GeographyPoint","geo","isArray","coordinates","GeographyPoint","$data.Guid","guid","toString","toDb","$data.Entity","$data.ObjectID","toISOString","replace","Blob","toBase64","escape","stringify","date","text","bool","b","toHexString","GeographyBase","stringifyToUrl","jaydata/core",2,"$C","Expressions","EntityExpressionVisitor","monitorDefinition","Visit","expression","context","methodName","result","canVisit","VisitExpressionNode","apply","arguments","getType","name","args","prototype","expressionTypeName","MonitorExpressionNode","MutateExpressionNode","ExpressionNode","walk","m","createExpressionWalker","dig","predicate","exp","value","push","StorageProviderBase","cfg","ctx","providerConfiguration","typeSystem","extend","dbCreation","storageProviders","DbCreationType","DropTableIfChanged","apiUrl","serviceUrl","maxDataServiceVersion","user","password","withCredentials","enableJSONP","_buildDbType_generateConvertToFunction","buildDbType_generateConvertToFunction","_buildDbType_modifyInstanceDefinition","buildDbType_modifyInstanceDefinition","initializeStore","callBack","createCallbackSetting","success","storageModel","logicalEntity","convertedItems","dbInstance","PhysicalType","entityState","memberDefinitions","getPublicMappedProperties","forEach","property","initData","Associations","association","FromMultiplicity","ToMultiplicity","refValue","FromPropertyName","rv","contentId","Guard","raise","__metadata","uri","EntityState","Modified","sMod","_storageModel","getStorageModel","tblName","TableName","pk","storageProvider","getEntityKeysValue","data","entitySet","getEntitySetFromElementType","ComplexTypes","cmpType","executeQuery","query","checkForRead","ex","bincount","eqbins","SimpleBinaryExpression","nodeType","constExp","fieldExp","left","ConstantExpression","EntityFieldExpression","right","source","entityType","defaultType","selector","memberName","getKeyProperties","queryText","tableName","_compile","error","request","url","type","method","rawDataList","cnt","console","dir","appendBasicAuth","prepareRequest","ajax","queryable","params","compiler","webApi","webApiCompiler","compiled","compile","saveChanges","changedItems","independentBlocks","buildIndependentBlocks","saveInternal","index2","disableBatch","defaults","_saveRestMany","_saveBatch","_saveRest","convertedItem","index","headers","contentType","dataType","Unchanged","Added","save_getInitData","save_addConcurrencyHeader","Deleted","Exception","that","status","xhr","item","memDef","propType","resolveType","computed","key","isAssignableTo","inverseProperty","converter","fieldConverter","resolveName","response","body","message","batchRequests","Content-Id","requestUri","requestData","__batchRequests","__changeRequests","statusCode","__batchResponses","__changeResponses","errors","ETag","Etag","etag","filter","concurrencyMode","ConcurrencyMode","Fixed","OData","batchHandler","physicalData","serializableObject","asArray","memdef","kind","MemberTypes","navProperty","complexProperty","notMapped","getTraceString","supportedDataTypes","Integer","String","Number","Boolean","Guid","Byte","SByte","Decimal","Float","Int16","Int32","Int64","Time","DateTimeOffset","writable","supportedBinaryOperators","equal","mapTo","allowedIn","FilterExpression","OrderExpression","notEqual","equalTyped","notEqualTyped","greaterThan","greaterThanOrEqual","lessThan","lessThenOrEqual","or","and","add","divide","multiply","subtract","modulo","in","supportedUnaryOperators","not","supportedFieldOperations","contains","parameters","startsWith","endsWith","ProjectionExpression","strLength","baseIndex","optional","toLowerCase","toUpperCase","trim","concat","day","hour","minute","month","second","year","round","floor","ceiling","enumerable","supportedSetOperations","map","toArray","single","some","invokable","frameType","SomeExpression","every","EveryExpression","take","skip","orderBy","orderByDescending","first","include","batchDelete","entity","keyValue","memDefs","createNew","field","getName","originalType","hexDigits","join","Authorization","__encodeBase64","val","chr1","chr2","enc1","enc2","enc3","b64array","input","base64","chr3","enc4","charCodeAt","isNaN","charAt","registerProvider","webApiProvider","provider","includes","mainEntitySet","queryFragments","urlText","modelBinderConfig","modelBinder","createModelBinderConfigCompiler","addAmp","VisitOrderExpression","orderCompiler","createwebApiOrderCompiler","VisitPagingExpression","pagingCompiler","createwebApiPagingCompiler","VisitIncludeExpression","includeFragment","split","tempData","entityContext","ToType","VisitProjectionExpression","projectionCompiler","createwebApiProjectionCompiler","VisitFilterExpression","filterCompiler","createwebApiWhereCompiler","VisitEntitySetExpression","instance","VisitServiceOperationExpression","serviceName","VisitBatchDeleteExpression","VisitConstantExpression","typeName","Entity","fullName","VisitCountExpression","lambdaPrefix","VisitParametricQueryExpression","VisitUnaryExpression","resolution","operand","VisitSimpleBinaryExpression","requireType","paramValue","orResolution","eqResolution","idValue","idCheck","createSimpleBinaryExpression","ExpressionType","Equal","Or","temp","VisitEntityFieldExpression","ComplexTypeExpression","VisitAssociationInfoExpression","associationInfo","VisitMemberInfoExpression","VisitQueryParameterExpression","VisitEntityFieldOperationExpression","operation","MemberInfoExpression","opDef","memberDefinition","opName","paramCounter","arg","VisitEntityExpression","lambda","AssociationInfoExpression","VisitFrameOperationExpression","Queryable","frameExpression","preparator","createQueryExpressionCreator","prep_expression","webApiWhereCompiler","frameContext","orderContext","OrderByDescending","VisitComplexTypeExpression","pagingContext","amount","Skip","Take","hasObjectLiteral","ObjectLiteralPath","modelBinderMapping","mapping","EntityExpression","EntitySetExpression","pop","VisitObjectLiteralExpression","tempObjectLiteralPath","members","member","VisitObjectFieldExpression","fieldName","slice",3,"defineProperty","_WebApiConverter","_WebApiProvider","./WebApiConverter.js","./WebApiProvider.js"],"mappings":"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","file":"WebApiProvider.min.js","sourcesContent":["﻿// JayData 1.5.0 CTP\r\n// Dual licensed under MIT and GPL v2\r\n// Copyright JayStack Technologies (http://jaydata.org/licensing)\r\n//\r\n// JayData is a standards-based, cross-platform Javascript library and a set of\r\n// practices to access and manipulate data from various online and offline sources.\r\n//\r\n// Credits:\r\n//     Hajnalka Battancs, Dániel József, János Roden, László Horváth, Péter Nochta\r\n//     Péter Zentai, Róbert Bónay, Szabolcs Czinege, Viktor Borza, Viktor Lázár,\r\n//     Zoltán Gyebrovszki, Gábor Dolla\r\n//\r\n// More info: http://jaydata.org\r\n(function(){\r\n\tvar interopDefine;\r\n\tif (typeof define != 'function' || (typeof define == 'function' && !define.amd)){\r\n\t\tinteropDefine = function(deps, callback){\r\n\t\t\tcallback();\r\n\t\t};\r\n\t}else interopDefine = define;\r\n\r\n\tinteropDefine(['jaydata'], function(){\r\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.$data = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _core = require('jaydata/core');\n\nvar _core2 = _interopRequireDefault(_core);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_core2.default.WebApiConverter = {\n    fromDb: {\n        '$data.Byte': _core2.default.Container.proxyConverter,\n        '$data.SByte': _core2.default.Container.proxyConverter,\n        '$data.Decimal': _core2.default.Container.proxyConverter,\n        '$data.Float': _core2.default.Container.proxyConverter,\n        '$data.Int16': _core2.default.Container.proxyConverter,\n        '$data.Int64': _core2.default.Container.proxyConverter,\n\n        '$data.Integer': _core2.default.Container.proxyConverter, //function (number) { return (typeof number === 'string' && /^\\d+$/.test(number)) ? parseInt(number) : number; },\n        '$data.Int32': _core2.default.Container.proxyConverter,\n        '$data.Number': _core2.default.Container.proxyConverter,\n        '$data.Date': function $dataDate(dbData) {\n            if (dbData) {\n                if (dbData instanceof Date) {\n                    return dbData;\n                } else if (dbData.substring(0, 6) === '/Date(') {\n                    return new Date(parseInt(dbData.substr(6)));\n                } else {\n                    //ISODate without Z? Safari compatible with Z\n                    if (dbData.indexOf('Z') === -1 && !dbData.match('T.*[+-]')) dbData += 'Z';\n                    return new Date(dbData);\n                }\n            } else {\n                return dbData;\n            }\n        },\n        '$data.DateTimeOffset': function $dataDateTimeOffset(dbData) {\n            if (dbData) {\n                if (dbData instanceof Date) {\n                    return dbData;\n                } else if (dbData.substring(0, 6) === '/Date(') {\n                    return new Date(parseInt(dbData.substr(6)));\n                } else {\n                    //ISODate without Z? Safari compatible with Z\n                    if (dbData.indexOf('Z') === -1 && !dbData.match('T.*[+-]')) dbData += 'Z';\n                    return new Date(dbData);\n                }\n            } else {\n                return dbData;\n            }\n        },\n        '$data.Time': _core2.default.Container.proxyConverter,\n        '$data.String': _core2.default.Container.proxyConverter,\n        '$data.Boolean': _core2.default.Container.proxyConverter,\n        '$data.Blob': function $dataBlob(v) {\n            if (typeof v == 'string') {\n                try {\n                    return _core2.default.Container.convertTo(atob(v), '$data.Blob');\n                } catch (e) {\n                    return v;\n                }\n            } else return v;\n        },\n        '$data.Object': function $dataObject(o) {\n            if (o === undefined) {\n                return new _core2.default.Object();\n            } else if (typeof o === 'string') {\n                return JSON.parse(o);\n            }return o;\n        },\n        '$data.Array': function $dataArray(o) {\n            if (o === undefined) {\n                return new _core2.default.Array();\n            } else if (o instanceof _core2.default.Array) {\n                return o;\n            }return JSON.parse(o);\n        },\n        '$data.GeographyPoint': function $dataGeographyPoint(geo) {\n            if (geo && (typeof geo === 'undefined' ? 'undefined' : _typeof(geo)) === 'object' && Array.isArray(geo.coordinates)) {\n                return new _core2.default.GeographyPoint(geo.coordinates);\n            }\n            return geo;\n        },\n        '$data.Guid': function $dataGuid(guid) {\n            return guid ? guid.toString() : guid;\n        }\n    },\n    toDb: {\n        '$data.Entity': _core2.default.Container.proxyConverter,\n        '$data.Byte': _core2.default.Container.proxyConverter,\n        '$data.SByte': _core2.default.Container.proxyConverter,\n        '$data.Decimal': _core2.default.Container.proxyConverter,\n        '$data.Float': _core2.default.Container.proxyConverter,\n        '$data.Int16': _core2.default.Container.proxyConverter,\n        '$data.Int64': _core2.default.Container.proxyConverter,\n        '$data.ObjectID': _core2.default.Container.proxyConverter,\n        '$data.Integer': _core2.default.Container.proxyConverter,\n        '$data.Int32': _core2.default.Container.proxyConverter,\n        '$data.Number': _core2.default.Container.proxyConverter,\n        '$data.Date': function $dataDate(e) {\n            return e ? e.toISOString().replace('Z', '') : e;\n        },\n        '$data.Time': _core2.default.Container.proxyConverter,\n        '$data.DateTimeOffset': function $dataDateTimeOffset(v) {\n            return v ? v.toISOString() : v;\n        },\n        '$data.String': _core2.default.Container.proxyConverter,\n        '$data.Boolean': _core2.default.Container.proxyConverter,\n        '$data.Blob': function $dataBlob(v) {\n            return v ? _core2.default.Blob.toBase64(v) : v;\n        },\n        '$data.Object': _core2.default.Container.proxyConverter,\n        '$data.Array': _core2.default.Container.proxyConverter,\n        '$data.GeographyPoint': _core2.default.Container.proxyConverter,\n        '$data.Guid': _core2.default.Container.proxyConverter\n    },\n    escape: {\n        '$data.Entity': function $dataEntity(e) {\n            return JSON.stringify(e);\n        },\n        '$data.Integer': _core2.default.Container.proxyConverter,\n        '$data.Int32': _core2.default.Container.proxyConverter,\n        '$data.Number': _core2.default.Container.proxyConverter, // double: 13.5D\n        '$data.Int16': _core2.default.Container.proxyConverter,\n        '$data.Byte': _core2.default.Container.proxyConverter,\n        '$data.SByte': _core2.default.Container.proxyConverter,\n        '$data.Decimal': function $dataDecimal(v) {\n            return v ? v + 'm' : v;\n        },\n        '$data.Float': function $dataFloat(v) {\n            return v ? v + 'f' : v;\n        },\n        '$data.Int64': function $dataInt64(v) {\n            return v ? v + 'L' : v;\n        },\n        '$data.Time': function $dataTime(v) {\n            return v ? \"time'\" + v + \"'\" : v;\n        },\n        '$data.DateTimeOffset': function $dataDateTimeOffset(date) {\n            return date ? \"datetimeoffset'\" + date + \"'\" : date;\n        },\n        '$data.Date': function $dataDate(date) {\n            return date ? \"datetime'\" + date + \"'\" : date;\n        },\n        '$data.String': function $dataString(text) {\n            return typeof text === 'string' ? \"'\" + text.replace(/'/g, \"''\") + \"'\" : text;\n        },\n        '$data.ObjectID': function $dataObjectID(text) {\n            return typeof text === 'string' ? \"'\" + text.replace(/'/g, \"''\") + \"'\" : text;\n        },\n        '$data.Boolean': function $dataBoolean(bool) {\n            return typeof bool === 'boolean' ? bool.toString() : bool;\n        },\n        '$data.Blob': function $dataBlob(b) {\n            return b ? \"X'\" + _core2.default.Blob.toHexString(_core2.default.Container.convertTo(atob(b), _core2.default.Blob)) + \"'\" : b;\n        },\n        '$data.Object': function $dataObject(o) {\n            return JSON.stringify(o);\n        },\n        '$data.Array': function $dataArray(o) {\n            return JSON.stringify(o);\n        },\n        '$data.GeographyPoint': function $dataGeographyPoint(g) {\n            if (g) {\n                return _core2.default.GeographyBase.stringifyToUrl(g);\n            }return g;\n        },\n        '$data.Guid': function $dataGuid(guid) {\n            return guid ? \"guid'\" + guid.toString() + \"'\" : guid;\n        }\n    }\n};\n\n},{\"jaydata/core\":\"jaydata/core\"}],2:[function(require,module,exports){\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _core = require('jaydata/core');\n\nvar _core2 = _interopRequireDefault(_core);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n(0, _core.$C)('$data.Expressions.ExpressionWalker', _core2.default.Expressions.EntityExpressionVisitor, null, {\n    constructor: function constructor(monitorDefinition) {\n        this.Visit = function (expression, context) {\n\n            var result = expression;\n            var methodName;\n            if (this.canVisit(expression)) {\n\n                //if (monitorDefinition.FilterExpressionNode) {\n\n                //};\n\n                if (monitorDefinition.VisitExpressionNode) {\n                    monitorDefinition.VisitExpressionNode.apply(monitorDefinition, arguments);\n                };\n\n                methodName = \"Visit\" + expression.getType().name;\n                if (methodName in monitorDefinition) {\n                    result = monitorDefinition[methodName].apply(monitorDefinition, arguments);\n                }\n            }\n\n            //apply is about 3-4 times faster then call on webkit\n\n            var args = arguments;\n            if (result !== expression) args = [result, context];\n            result = _core2.default.Expressions.EntityExpressionVisitor.prototype.Visit.apply(this, args);\n\n            args = [result, context];\n\n            if (this.canVisit(result)) {\n                var expressionTypeName = result.getType().name;\n                if (monitorDefinition.MonitorExpressionNode) {\n                    monitorDefinition.MonitorExpressionNode.apply(monitorDefinition, args);\n                }\n                methodName = \"Monitor\" + expressionTypeName;\n                if (methodName in monitorDefinition) {\n                    monitorDefinition[methodName].apply(monitorDefinition, args);\n                }\n\n                if (monitorDefinition.MutateExpressionNode) {\n                    monitorDefinition.MutateExpressionNode.apply(monitorDefinition, args);\n                }\n                methodName = \"Mutate\" + expressionTypeName;\n                if (methodName in monitorDefinition) {\n                    result = monitorDefinition[methodName].apply(monitorDefinition, args);\n                }\n            }\n            return result;\n        };\n    }\n});\n_core2.default.Expressions.ExpressionNode.prototype.walk = function (monitorDefinition, context) {\n    var m = _core.Container.createExpressionWalker(monitorDefinition);\n    return m.Visit(this, context);\n};\n\n_core2.default.Expressions.ExpressionNode.prototype.dig = function (predicate) {\n    var result = [];\n    this.walk({\n        MonitorExpressionNode: function MonitorExpressionNode(exp) {\n            var value;\n            if (value = predicate(exp)) {\n                result.push(value);\n            }\n        }\n    });\n    return result;\n};\n\n(0, _core.$C)('$data.storageProviders.webApi.webApiProvider', _core2.default.StorageProviderBase, null, {\n    constructor: function constructor(cfg, ctx) {\n        this.context = ctx;\n        this.providerConfiguration = _core2.default.typeSystem.extend({\n            dbCreation: _core2.default.storageProviders.DbCreationType.DropTableIfChanged,\n            apiUrl: \"/odata.svc\",\n            serviceUrl: \"\",\n            maxDataServiceVersion: '2.0',\n            user: null,\n            password: null,\n            withCredentials: false,\n            enableJSONP: false\n            //disableBatch: undefined\n        }, cfg);\n        if (this.context && this.context._buildDbType_generateConvertToFunction && this.buildDbType_generateConvertToFunction) {\n            this.context._buildDbType_generateConvertToFunction = this.buildDbType_generateConvertToFunction;\n        }\n        if (this.context && this.context._buildDbType_modifyInstanceDefinition && this.buildDbType_modifyInstanceDefinition) {\n            this.context._buildDbType_modifyInstanceDefinition = this.buildDbType_modifyInstanceDefinition;\n        }\n    },\n    initializeStore: function initializeStore(callBack) {\n        callBack = _core2.default.typeSystem.createCallbackSetting(callBack);\n        callBack.success(this.context);\n    },\n    buildDbType_generateConvertToFunction: function buildDbType_generateConvertToFunction(storageModel, context) {\n        return function (logicalEntity, convertedItems) {\n            var dbInstance = new storageModel.PhysicalType();\n            dbInstance.entityState = logicalEntity.entityState;\n\n            storageModel.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function (property) {\n                dbInstance.initData[property.name] = logicalEntity[property.name];\n            }, this);\n\n            if (storageModel.Associations) {\n                storageModel.Associations.forEach(function (association) {\n                    if (association.FromMultiplicity == \"*\" && association.ToMultiplicity == \"0..1\" || association.FromMultiplicity == \"0..1\" && association.ToMultiplicity == \"1\" || association.FromMultiplicity == '$$unbound') {\n                        var refValue = logicalEntity[association.FromPropertyName];\n                        if (refValue !== null && refValue !== undefined) {\n                            if (refValue instanceof _core2.default.Array) {\n                                dbInstance.initData[association.FromPropertyName] = dbInstance[association.FromPropertyName] || [];\n                                refValue.forEach(function (rv) {\n                                    var contentId = convertedItems.indexOf(rv);\n                                    if (contentId < 0) {\n                                        _core.Guard.raise(\"Dependency graph error\");\n                                    }\n                                    dbInstance.initData[association.FromPropertyName].push({ __metadata: { uri: \"$\" + (contentId + 1) } });\n                                }, this);\n                            } else {\n                                if (refValue.entityState === _core2.default.EntityState.Modified) {\n                                    var sMod = context._storageModel.getStorageModel(refValue.getType());\n                                    var tblName = sMod.TableName;\n                                    var pk = '(' + context.storageProvider.getEntityKeysValue({ data: refValue, entitySet: context.getEntitySetFromElementType(refValue.getType()) }) + ')';\n                                    dbInstance.initData[association.FromPropertyName] = { __metadata: { uri: tblName + pk } };\n                                } else {\n                                    var contentId = convertedItems.indexOf(refValue);\n                                    if (contentId < 0) {\n                                        _core.Guard.raise(\"Dependency graph error\");\n                                    }\n                                    dbInstance.initData[association.FromPropertyName] = { __metadata: { uri: \"$\" + (contentId + 1) } };\n                                }\n                            }\n                        }\n                    }\n                }, this);\n            }\n            if (storageModel.ComplexTypes) {\n                storageModel.ComplexTypes.forEach(function (cmpType) {\n                    dbInstance.initData[cmpType.FromPropertyName] = logicalEntity[cmpType.FromPropertyName];\n                }, this);\n            }\n            return dbInstance;\n        };\n    },\n    buildDbType_modifyInstanceDefinition: function buildDbType_modifyInstanceDefinition() {\n        return;\n    },\n    executeQuery: function executeQuery(query, callBack) {\n        callBack = _core2.default.typeSystem.createCallbackSetting(callBack);\n\n        var result;\n        try {\n            result = this._compile(query);\n        } catch (e) {\n            callBack.error(e);\n            return;\n        }\n        var schema = this.context;\n        //console.dir(expressionTree);\n        //console.log(query.expression.walk);\n        function checkForRead(query) {\n\n            var ex = _core2.default.Expressions;\n            var bincount = 0;\n            var eqbins = query.expression.dig(function (exp) {\n                if (exp instanceof ex.SimpleBinaryExpression) {\n                    bincount++;\n                }\n                if (exp.nodeType == \"equal\") {\n                    var constExp = null;\n                    var fieldExp = null;\n                    if (exp.left instanceof ex.ConstantExpression) constExp = exp.left;\n                    if (exp.left instanceof ex.EntityFieldExpression) fieldExp = exp.left;\n                    if (exp.right instanceof ex.ConstantExpression) constExp = exp.right;\n                    if (exp.right instanceof ex.EntityFieldExpression) fieldExp = exp.right;\n                    if (fieldExp && constExp) {\n\n                        if (fieldExp.source.entityType === query.defaultType && fieldExp.selector.memberName == query.defaultType.memberDefinitions.getKeyProperties()[0].name) {\n                            return constExp.value;\n                        }\n                    }\n                }\n            });\n            if (bincount == 1 && eqbins.length == 1) {\n                result.queryText = \"/\" + query.context.getEntitySetFromElementType(query.defaultType).tableName + \"/\" + eqbins[0].toString();\n            };\n            //query.w\n        }\n        checkForRead(query);\n\n        var request = {\n            url: this.providerConfiguration.apiUrl + result.queryText,\n            type: result.method,\n            success: function success(data) {\n                if (callBack.success) {\n                    query.rawDataList = typeof data === 'string' ? [{ cnt: data }] : data;\n                    callBack.success(query);\n                }\n            },\n            error: function error() {\n                console.dir(arguments);\n                callBack.error(arguments);\n                //callBack.error(errorThrow || new Exception('Request failed', 'RequestError', arguments));\n            }\n        };\n\n        this.appendBasicAuth(request, this.providerConfiguration.user, this.providerConfiguration.password, this.providerConfiguration.withCredentials);\n\n        this.context.prepareRequest.call(this, request);\n        _core2.default.ajax(request);\n    },\n    _compile: function _compile(queryable, params) {\n        var compiler = new _core2.default.storageProviders.webApi.webApiCompiler();\n        var compiled = compiler.compile(queryable);\n        return compiled;\n    },\n    saveChanges: function saveChanges(callBack, changedItems) {\n        if (changedItems.length > 0) {\n            var independentBlocks = this.buildIndependentBlocks(changedItems);\n            this.saveInternal(independentBlocks, 0, callBack);\n        } else {\n            callBack.success(0);\n        }\n    },\n    saveInternal: function saveInternal(independentBlocks, index2, callBack) {\n        if ((this.providerConfiguration.disableBatch === true || _typeof(_core2.default.defaults) === 'object' && _core2.default.defaults.disableBatch === true) && typeof this._saveRestMany === 'function') {\n            this._saveRestMany(independentBlocks, index2, callBack);\n        } else {\n            if (independentBlocks.length > 1 || independentBlocks.length == 1 && independentBlocks[0].length > 1) {\n                this._saveBatch(independentBlocks, index2, callBack);\n            } else {\n                this._saveRest(independentBlocks, index2, callBack);\n            }\n        }\n    },\n    _saveRest: function _saveRest(independentBlocks, index2, callBack) {\n        var batchRequests = [];\n        var convertedItem = [];\n        var request;\n        for (var index = 0; index < independentBlocks.length; index++) {\n            for (var i = 0; i < independentBlocks[index].length; i++) {\n                convertedItem.push(independentBlocks[index][i].data);\n                request = {\n                    url: this.providerConfiguration.apiUrl + '/',\n                    headers: {},\n                    contentType: \"application/json\",\n                    dataType: \"json\"\n                };\n\n                //request.headers = { \"Content-Id\": convertedItem.length };\n                switch (independentBlocks[index][i].data.entityState) {\n                    case _core2.default.EntityState.Unchanged:\n                        continue;break;\n                    case _core2.default.EntityState.Added:\n                        request.type = \"POST\";\n                        request.url += independentBlocks[index][i].entitySet.tableName;\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\n                        break;\n                    case _core2.default.EntityState.Modified:\n                        request.type = \"PUT\";\n                        request.url += independentBlocks[index][i].entitySet.tableName;\n                        request.url += \"/\" + this.getEntityKeysValue(independentBlocks[index][i]);\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\n                        break;\n                    case _core2.default.EntityState.Deleted:\n                        request.type = \"DELETE\";\n                        request.url += independentBlocks[index][i].entitySet.tableName;\n                        request.url += \"/\" + this.getEntityKeysValue(independentBlocks[index][i]);\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\n                        break;\n                    default:\n                        _core.Guard.raise(new _core.Exception(\"Not supported Entity state\"));\n                }\n                if (request.data) {\n                    request.data = JSON.stringify(request.data);\n                }\n                //batchRequests.push(request);\n            }\n        }\n        var that = this;\n\n        request.success = function (data, status, xhr) {\n            var arg = arguments;\n            var s = xhr.status;\n            if (s >= 200 && s < 300) {\n\n                if (data) {\n                    var item = convertedItem[0];\n                    item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\n                        var propType = _core.Container.resolveType(memDef.type);\n                        if (memDef.computed || memDef.key || !propType.isAssignableTo && !memDef.inverseProperty) {\n                            //if (memDef.concurrencyMode === $data.ConcurrencyMode.Fixed) {\n                            //    item[memDef.name] = response.headers.ETag || response.headers.Etag;\n                            //} else {\n                            var converter = that.fieldConverter.fromDb[_core.Container.resolveName(memDef.type)];\n                            item[memDef.name] = converter ? converter(data[memDef.name]) : data[memDef.name];\n                            //}\n                        }\n                    }, this);\n                }\n                //if (s == 204) {\n                //    //TODO versioning/ETag\n                //    if (response.headers.ETag || response.headers.Etag) {\n                //        var property = item.getType().memberDefinitions.getPublicMappedProperties().filter(function (memDef) { return memDef.concurrencyMode === $data.ConcurrencyMode.Fixed });\n                //        if (property && property[0]) {\n                //            item[property[0].name] = response.headers.ETag || response.headers.Etag;\n                //        }\n                //    }\n\n                //} else {\n                //    //its optional to send back content from webapi\n                //    if (data) {\n                //        //item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\n                //        //    if (memDef.computed || memDef.key) {\n                //        //        if (memDef.concurrencyMode === $data.ConcurrencyMode.Fixed) {\n                //        //            item[memDef.name] = response.headers.ETag || response.headers.Etag;\n                //        //        } else {\n                //        //            var converter = that.fieldConverter.fromDb[Container.resolveType(memDef.type)];\n                //        //            item[memDef.name] = converter ? converter(data[memDef.name]) : data[memDef.name];\n                //        //        }\n                //        //    }\n                //        //}, this);\n                //        //item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\n                //        //    var propType = Container.resolveType(memDef.type);\n                //        //    if (memDef.computed || memDef.key || (!propType.isAssignableTo && !memDef.inverseProperty)) {\n                //        //        if (memDef.concurrencyMode === $data.ConcurrencyMode.Fixed) {\n                //        //            item[memDef.name] = response.headers.ETag || response.headers.Etag;\n                //        //        } else {\n                //        //            var converter = that.fieldConverter.fromDb[Container.resolveName(memDef.type)];\n                //        //            item[memDef.name] = converter ? converter(data[memDef.name]) : data[memDef.name];\n                //        //        }\n                //        //    }\n                //        //}, this);\n                //    }\n                //}\n\n                if (callBack.success) {\n                    callBack.success(convertedItem.length);\n                }\n            } else {\n                callBack.error(response);\n            }\n        };\n        request.error = function (e) {\n            callBack.error(new _core.Exception((e.response || {}).body, e.message, e));\n        };\n\n        this.appendBasicAuth(request, this.providerConfiguration.user, this.providerConfiguration.password, this.providerConfiguration.withCredentials);\n        //if (this.providerConfiguration.user) {\n        //    requestData[0].user = this.providerConfiguration.user;\n        //    requestData[0].password = this.providerConfiguration.password || \"\";\n        //}\n\n        this.context.prepareRequest.call(this, request);\n        _core2.default.ajax(request);\n        //OData.request.apply(this, requestData);\n    },\n    _saveBatch: function _saveBatch(independentBlocks, index2, callBack) {\n        var batchRequests = [];\n        var convertedItem = [];\n        for (var index = 0; index < independentBlocks.length; index++) {\n            for (var i = 0; i < independentBlocks[index].length; i++) {\n                convertedItem.push(independentBlocks[index][i].data);\n                var request = {};\n                request.headers = { \"Content-Id\": convertedItem.length };\n                switch (independentBlocks[index][i].data.entityState) {\n                    case _core2.default.EntityState.Unchanged:\n                        continue;break;\n                    case _core2.default.EntityState.Added:\n                        request.method = \"POST\";\n                        request.requestUri = independentBlocks[index][i].entitySet.tableName;\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\n                        break;\n                    case _core2.default.EntityState.Modified:\n                        request.method = \"MERGE\";\n                        request.requestUri = independentBlocks[index][i].entitySet.tableName;\n                        request.requestUri += \"(\" + this.getEntityKeysValue(independentBlocks[index][i]) + \")\";\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\n                        break;\n                    case _core2.default.EntityState.Deleted:\n                        request.method = \"DELETE\";\n                        request.requestUri = independentBlocks[index][i].entitySet.tableName;\n                        request.requestUri += \"(\" + this.getEntityKeysValue(independentBlocks[index][i]) + \")\";\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\n                        break;\n                    default:\n                        _core.Guard.raise(new _core.Exception(\"Not supported Entity state\"));\n                }\n                batchRequests.push(request);\n            }\n        }\n        var that = this;\n\n        var requestData = [{\n            requestUri: this.providerConfiguration.apiUrl + \"/$batch\",\n            method: \"POST\",\n            data: {\n                __batchRequests: [{ __changeRequests: batchRequests }]\n            }\n        }, function (data, response) {\n            if (response.statusCode == 202) {\n                var result = data.__batchResponses[0].__changeResponses;\n                var errors = [];\n\n                for (var i = 0; i < result.length; i++) {\n                    if (result[i].statusCode > 200 && result[i].statusCode < 300) {\n                        var item = convertedItem[i];\n                        if (result[i].statusCode == 204) {\n                            if (result[i].headers.ETag || result[i].headers.Etag || result[i].headers.etag) {\n                                var property = item.getType().memberDefinitions.getPublicMappedProperties().filter(function (memDef) {\n                                    return memDef.concurrencyMode === _core2.default.ConcurrencyMode.Fixed;\n                                });\n                                if (property && property[0]) {\n                                    item[property[0].name] = result[i].headers.ETag || result[i].headers.Etag || result[i].headers.etag;\n                                }\n                            }\n                            continue;\n                        }\n\n                        item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\n                            //TODO: is this correct?\n                            if (memDef.computed || memDef.key) {\n                                if (memDef.concurrencyMode === _core2.default.ConcurrencyMode.Fixed) {\n                                    item[memDef.name] = result[i].headers.ETag || result[i].headers.Etag || result[i].headers.etag;\n                                } else {\n                                    var converter = that.fieldConverter.fromDb[_core.Container.resolveType(memDef.type)];\n                                    item[memDef.name] = converter ? converter(result[i].data[memDef.name]) : result[i].data[memDef.name];\n                                }\n                            }\n                        }, this);\n                    } else {\n                        errors.push(new _core.Exception((result[i].response || {}).body, result[i].message, result[i]));\n                    }\n                }\n                if (errors.length > 0) {\n                    callBack.error(new _core.Exception('See inner exceptions', 'Batch failed', errors));\n                } else if (callBack.success) {\n                    callBack.success(convertedItem.length);\n                }\n            } else {\n                callBack.error(response);\n            }\n        }, function (e) {\n            callBack.error(new _core.Exception((e.response || {}).body, e.message, e));\n        }, OData.batchHandler];\n\n        this.appendBasicAuth(requestData[0], this.providerConfiguration.user, this.providerConfiguration.password, this.providerConfiguration.withCredentials);\n        //if (this.providerConfiguration.user) {\n        //    requestData[0].user = this.providerConfiguration.user;\n        //    requestData[0].password = this.providerConfiguration.password || \"\";\n        //}\n\n        this.context.prepareRequest.call(this, requestData);\n        OData.request.apply(this, requestData);\n    },\n    save_getInitData: function save_getInitData(item, convertedItems) {\n        item.physicalData = this.context._storageModel.getStorageModel(item.data.getType()).PhysicalType.convertTo(item.data, convertedItems);\n        var serializableObject = {};\n        item.physicalData.getType().memberDefinitions.asArray().forEach(function (memdef) {\n            if (memdef.kind == _core2.default.MemberTypes.navProperty || memdef.kind == _core2.default.MemberTypes.complexProperty || memdef.kind == _core2.default.MemberTypes.property && !memdef.notMapped) {\n                //if (typeof memdef.concurrencyMode === 'undefined' &&\n                //    (memdef.key === true || item.data.entityState === $data.EntityState.Added ||\n                //    item.data.changedProperties.some(function (def) { return def.name === memdef.name; }))\n                //)\n                serializableObject[memdef.name] = item.physicalData[memdef.name];\n            }\n        }, this);\n        return serializableObject;\n    },\n    save_addConcurrencyHeader: function save_addConcurrencyHeader(item, headers) {\n        var property = item.data.getType().memberDefinitions.getPublicMappedProperties().filter(function (memDef) {\n            return memDef.concurrencyMode === _core2.default.ConcurrencyMode.Fixed;\n        });\n        if (property && property[0]) {\n            headers['If-Match'] = item.data[property[0].name];\n            //item.data[property[0].name] = \"\";\n        }\n    },\n    getTraceString: function getTraceString(queryable) {\n        var sqlText = this._compile(queryable);\n        return queryable;\n    },\n    supportedDataTypes: { value: [_core2.default.Integer, _core2.default.String, _core2.default.Number, _core2.default.Blob, _core2.default.Boolean, _core2.default.Date, _core2.default.Object, _core2.default.GeographyPoint, _core2.default.Guid, _core2.default.Byte, _core2.default.SByte, _core2.default.Decimal, _core2.default.Float, _core2.default.Int16, _core2.default.Int32, _core2.default.Int64, _core2.default.Time, _core2.default.DateTimeOffset], writable: false },\n\n    supportedBinaryOperators: {\n        value: {\n            equal: { mapTo: 'eq', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            notEqual: { mapTo: 'ne', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            equalTyped: { mapTo: 'eq', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            notEqualTyped: { mapTo: 'ne', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            greaterThan: { mapTo: 'gt', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            greaterThanOrEqual: { mapTo: 'ge', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n\n            lessThan: { mapTo: 'lt', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            lessThenOrEqual: { mapTo: 'le', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            or: { mapTo: 'or', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            and: { mapTo: 'and', dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n\n            add: { mapTo: 'add', dataType: \"number\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            divide: { mapTo: 'div', allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            multiply: { mapTo: 'mul', allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            subtract: { mapTo: 'sub', allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n            modulo: { mapTo: 'mod', allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] },\n\n            \"in\": { mapTo: \"in\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression] }\n        }\n    },\n\n    supportedUnaryOperators: {\n        value: {\n            not: { mapTo: 'not' }\n        }\n    },\n\n    supportedFieldOperations: {\n        value: {\n            /* string functions */\n\n            contains: {\n                mapTo: \"substringof\",\n                dataType: \"boolean\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"substring\", dataType: \"string\" }, { name: \"@expression\" }]\n            },\n\n            startsWith: {\n                mapTo: \"startswith\",\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"strFragment\", dataType: \"string\" }]\n            },\n\n            endsWith: {\n                mapTo: \"endswith\",\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"strFragment\", dataType: \"string\" }]\n            },\n\n            length: {\n                dataType: \"number\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.ProjectionExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\n            },\n            strLength: {\n                mapTo: \"length\",\n                dataType: \"number\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.ProjectionExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\n            },\n\n            indexOf: {\n                dataType: \"number\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                mapTo: \"indexof\",\n                baseIndex: 1,\n                parameters: [{ name: '@expression', dataType: \"string\" }, { name: 'strFragment', dataType: 'string' }]\n            },\n\n            replace: {\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: '@expression', dataType: \"string\" }, { name: 'strFrom', dataType: 'string' }, { name: 'strTo', dataType: 'string' }]\n            },\n\n            substr: {\n                mapTo: \"substring\",\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"startFrom\", dataType: \"number\" }, { name: \"length\", dataType: \"number\", optional: \"true\" }]\n            },\n\n            toLowerCase: {\n                mapTo: \"tolower\",\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\n            },\n\n            toUpperCase: {\n                mapTo: \"toupper\",\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\n\n            },\n\n            trim: {\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\n            },\n\n            concat: {\n                dataType: \"string\", allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"strFragment\", dataType: \"string\" }]\n            },\n\n            /* data functions */\n\n            day: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n            hour: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n            minute: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n            month: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n            second: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n            year: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n\n            /* number functions */\n            round: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n            floor: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            },\n            ceiling: {\n                allowedIn: [_core2.default.Expressions.FilterExpression, _core2.default.Expressions.OrderExpression],\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\n            }\n        },\n        enumerable: true,\n        writable: true\n    },\n    supportedSetOperations: {\n        value: {\n            filter: {},\n            map: {},\n            length: {},\n            forEach: {},\n            toArray: {},\n            single: {},\n            some: {\n                invokable: false,\n                allowedIn: [_core2.default.Expressions.FilterExpression],\n                parameters: [{ name: \"filter\", dataType: \"$data.Queryable\" }],\n                mapTo: 'any',\n                frameType: _core2.default.Expressions.SomeExpression\n            },\n            every: {\n                invokable: false,\n                allowedIn: [_core2.default.Expressions.FilterExpression],\n                parameters: [{ name: \"filter\", dataType: \"$data.Queryable\" }],\n                mapTo: 'all',\n                frameType: _core2.default.Expressions.EveryExpression\n            },\n            take: {},\n            skip: {},\n            orderBy: {},\n            orderByDescending: {},\n            first: {},\n            include: {},\n            batchDelete: {}\n        },\n        enumerable: true,\n        writable: true\n    },\n    fieldConverter: { value: _core2.default.WebApiConverter },\n    getEntityKeysValue: function getEntityKeysValue(entity) {\n        var result = [];\n        var keyValue = undefined;\n\n        var memDefs = entity.entitySet.createNew.memberDefinitions.asArray();\n        for (var i = 0, l = memDefs.length; i < l; i++) {\n            var field = memDefs[i];\n            if (field.key) {\n                keyValue = entity.data[field.name];\n                switch (_core.Container.getName(field.originalType)) {\n                    case \"$data.Guid\":\n                    case \"Edm.Guid\":\n                        keyValue = \"guid'\" + (keyValue ? keyValue.value : keyValue) + \"'\";\n                        break;\n                    case \"$data.Blob\":\n                    case \"Edm.Binary\":\n                        keyValue = \"binary'\" + keyValue + \"'\";\n                        break;\n                    case \"Edm.Byte\":\n                        var hexDigits = '0123456789ABCDEF';\n                        keyValue = hexDigits[i >> 4 & 15] + hexDigits[i & 15];\n                        break;\n                    case \"$data.Date\":\n                    case \"Edm.DateTime\":\n                        keyValue = \"datetime'\" + keyValue.toISOString() + \"'\";\n                        break;\n                    case \"Edm.Decimal\":\n                        keyValue = keyValue + \"M\";\n                        break;\n                    case \"Edm.Single\":\n                        keyValue = keyValue + \"f\";\n                        break;\n                    case \"Edm.Int64\":\n                        keyValue = keyValue + \"L\";\n                        break;\n                    case 'Edm.String':\n                    case \"$data.String\":\n                        keyValue = \"'\" + keyValue + \"'\";\n                        break;\n                }\n                result.push(field.name + \"=\" + keyValue);\n            }\n        }\n        if (result.length > 1) {\n            return result.join(\",\");\n        }\n        return keyValue;\n    },\n    appendBasicAuth: function appendBasicAuth(request, user, password, withCredentials) {\n        request.headers = request.headers || {};\n        if (!request.headers.Authorization && user && password) {\n            request.headers.Authorization = \"Basic \" + this.__encodeBase64(user + \":\" + password);\n            request.withCredentials = withCredentials;\n        }\n    },\n    __encodeBase64: function __encodeBase64(val) {\n        var b64array = \"ABCDEFGHIJKLMNOP\" + \"QRSTUVWXYZabcdef\" + \"ghijklmnopqrstuv\" + \"wxyz0123456789+/\" + \"=\";\n\n        var input = val;\n        var base64 = \"\";\n        var hex = \"\";\n        var chr1,\n            chr2,\n            chr3 = \"\";\n        var enc1,\n            enc2,\n            enc3,\n            enc4 = \"\";\n        var i = 0;\n\n        do {\n            chr1 = input.charCodeAt(i++);\n            chr2 = input.charCodeAt(i++);\n            chr3 = input.charCodeAt(i++);\n\n            enc1 = chr1 >> 2;\n            enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n            enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n            enc4 = chr3 & 63;\n\n            if (isNaN(chr2)) {\n                enc3 = enc4 = 64;\n            } else if (isNaN(chr3)) {\n                enc4 = 64;\n            }\n\n            base64 = base64 + b64array.charAt(enc1) + b64array.charAt(enc2) + b64array.charAt(enc3) + b64array.charAt(enc4);\n            chr1 = chr2 = chr3 = \"\";\n            enc1 = enc2 = enc3 = enc4 = \"\";\n        } while (i < input.length);\n\n        return base64;\n    }\n}, null);\n\n_core2.default.StorageProviderBase.registerProvider(\"webApi\", _core2.default.storageProviders.webApi.webApiProvider);\n\n(0, _core.$C)('$data.storageProviders.webApi.webApiCompiler', _core2.default.Expressions.EntityExpressionVisitor, null, {\n    constructor: function constructor() {\n        this.context = {};\n        this.provider = {};\n        //this.logicalType = null;\n        this.includes = null;\n        this.mainEntitySet = null;\n    },\n    compile: function compile(query) {\n\n        this.provider = query.context.storageProvider;\n        this.context = query.context;\n        this.mainEntitySet = query.context.getEntitySetFromElementType(query.defaultType);\n\n        var queryFragments = { urlText: \"\" };\n\n        this.Visit(query.expression, queryFragments);\n\n        query.modelBinderConfig = {};\n        var modelBinder = _core.Container.createModelBinderConfigCompiler(query, this.includes, true);\n        modelBinder.Visit(query.expression);\n\n        var queryText = queryFragments.urlText;\n        var addAmp = false;\n        for (var name in queryFragments) {\n            if (name != \"urlText\" && name != \"actionPack\" && name != \"data\" && name != \"lambda\" && name != \"method\" && queryFragments[name] != \"\") {\n                if (addAmp) {\n                    queryText += \"&\";\n                } else {\n                    queryText += \"?\";\n                }\n                addAmp = true;\n                if (name != \"$urlParams\") {\n                    queryText += name + '=' + queryFragments[name];\n                } else {\n                    queryText += queryFragments[name];\n                }\n            }\n        }\n        query.queryText = queryText;\n\n        return {\n            queryText: queryText,\n            method: queryFragments.method || 'GET',\n            params: []\n        };\n    },\n    VisitOrderExpression: function VisitOrderExpression(expression, context) {\n        this.Visit(expression.source, context);\n\n        var orderCompiler = _core.Container.createwebApiOrderCompiler(this.provider);\n        orderCompiler.compile(expression, context);\n    },\n    VisitPagingExpression: function VisitPagingExpression(expression, context) {\n        this.Visit(expression.source, context);\n\n        var pagingCompiler = _core.Container.createwebApiPagingCompiler();\n        pagingCompiler.compile(expression, context);\n    },\n    VisitIncludeExpression: function VisitIncludeExpression(expression, context) {\n        this.Visit(expression.source, context);\n        if (!context['$select']) {\n            if (context['$expand']) {\n                context['$expand'] += ',';\n            } else {\n                context['$expand'] = '';\n            }\n            context['$expand'] += expression.selector.value.replace(/\\./g, '/');\n\n            this.includes = this.includes || [];\n            var includeFragment = expression.selector.value.split('.');\n            var tempData = null;\n            var storageModel = this.mainEntitySet.entityContext._storageModel.getStorageModel(this.mainEntitySet.createNew);\n            for (var i = 0; i < includeFragment.length; i++) {\n                if (tempData) {\n                    tempData += '.' + includeFragment[i];\n                } else {\n                    tempData = includeFragment[i];\n                }\n                var association = storageModel.Associations[includeFragment[i]];\n                if (association) {\n                    if (!this.includes.some(function (include) {\n                        return include.name == tempData;\n                    }, this)) {\n                        this.includes.push({ name: tempData, type: association.ToType });\n                    }\n                } else {\n                    _core.Guard.raise(new _core.Exception(\"The given include path is invalid: \" + expression.selector.value + \", invalid point: \" + tempData));\n                }\n                storageModel = this.mainEntitySet.entityContext._storageModel.getStorageModel(association.ToType);\n            }\n        }\n    },\n    VisitProjectionExpression: function VisitProjectionExpression(expression, context) {\n        this.Visit(expression.source, context);\n\n        var projectionCompiler = _core.Container.createwebApiProjectionCompiler(this.context);\n        projectionCompiler.compile(expression, context);\n    },\n    VisitFilterExpression: function VisitFilterExpression(expression, context) {\n        ///<param name=\"expression\" type=\"$data.Expressions.FilterExpression\" />\n\n        this.Visit(expression.source, context);\n\n        var filterCompiler = _core.Container.createwebApiWhereCompiler(this.provider);\n        context.data = \"\";\n        filterCompiler.compile(expression.selector, context);\n        context[\"$filter\"] = context.data;\n        context.data = \"\";\n    },\n    VisitEntitySetExpression: function VisitEntitySetExpression(expression, context) {\n        context.urlText += \"/\" + expression.instance.tableName;\n        //this.logicalType = expression.instance.elementType;\n        if (expression.params) {\n            for (var i = 0; i < expression.params.length; i++) {\n                this.Visit(expression.params[i], context);\n            }\n        }\n    },\n    VisitServiceOperationExpression: function VisitServiceOperationExpression(expression, context) {\n        context.urlText += \"/\" + expression.cfg.serviceName;\n        //this.logicalType = expression.returnType;\n        if (expression.params) {\n            for (var i = 0; i < expression.params.length; i++) {\n                this.Visit(expression.params[i], context);\n            }\n        }\n    },\n    VisitBatchDeleteExpression: function VisitBatchDeleteExpression(expression, context) {\n        this.Visit(expression.source, context);\n        context.urlText += '/$batchDelete';\n        context.method = 'DELETE';\n    },\n\n    VisitConstantExpression: function VisitConstantExpression(expression, context) {\n        if (context['$urlParams']) {\n            context['$urlParams'] += '&';\n        } else {\n            context['$urlParams'] = '';\n        }\n\n        var typeName = _core.Container.resolveName(expression.type);\n        if (expression.value instanceof _core2.default.Entity) typeName = _core2.default.Entity.fullName;\n\n        var converter = this.provider.fieldConverter.toDb[typeName];\n        var value = converter ? converter(expression.value) : expression.value;\n\n        converter = this.provider.fieldConverter.escape[typeName];\n        value = converter ? converter(value) : value;\n\n        /*var value;\r\n        if (expression.value instanceof $data.Entity) {\r\n            value = this.provider.fieldConverter.toDb['$data.Entity'](expression.value);\r\n        } else {\r\n            //var valueType = Container.getTypeName(expression.value);\r\n            value = this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(expression.type))](expression.value);\r\n        }*/\n        context['$urlParams'] += expression.name + '=' + value;\n    },\n    //    VisitConstantExpression: function (expression, context) {\n    //        if (context['$urlParams']) { context['$urlParams'] += '&'; } else { context['$urlParams'] = ''; }\n    //\n    //\n    //        var valueType = Container.getTypeName(expression.value);\n    //\n    //\n    //\n    //        context['$urlParams'] += expression.name + '=' + this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(valueType))](expression.value);\n    //    },\n\n    VisitCountExpression: function VisitCountExpression(expression, context) {\n        this.Visit(expression.source, context);\n        context.urlText += '/$count';\n    }\n}, {});\n\n(0, _core.$C)('$data.storageProviders.webApi.webApiWhereCompiler', _core2.default.Expressions.EntityExpressionVisitor, null, {\n    constructor: function constructor(provider, lambdaPrefix) {\n        this.provider = provider;\n        this.lambdaPrefix = lambdaPrefix;\n    },\n\n    compile: function compile(expression, context) {\n        this.Visit(expression, context);\n    },\n\n    VisitParametricQueryExpression: function VisitParametricQueryExpression(expression, context) {\n        this.Visit(expression.expression, context);\n    },\n\n    VisitUnaryExpression: function VisitUnaryExpression(expression, context) {\n        context.data += expression.resolution.mapTo;\n        context.data += \"(\";\n        this.Visit(expression.operand, context);\n        context.data += \")\";\n    },\n\n    VisitSimpleBinaryExpression: function VisitSimpleBinaryExpression(expression, context) {\n        context.data += \"(\";\n        //TODO refactor!!!\n        if (expression.nodeType == \"in\") {\n            _core.Guard.requireType(\"expression.right\", expression.type, _core2.default.Expressions.ConstantExpression);\n            var paramValue = expression.right.value;\n            if (!(paramValue instanceof Array)) {\n                _core.Guard.raise(new _core.Exception(\"Right to the 'in' operator must be an array value\"));\n            }\n            var result = null;\n            var orResolution = { mapTo: \"or\", dataType: \"boolean\", name: \"or\" };\n            var eqResolution = { mapTo: \"eq\", dataType: \"boolean\", name: \"equal\" };\n\n            paramValue.forEach(function (item) {\n                var idValue = item;\n                var idCheck = _core.Container.createSimpleBinaryExpression(expression.left, idValue, _core2.default.Expressions.ExpressionType.Equal, \"==\", \"boolean\", eqResolution);\n                if (result) {\n                    result = _core.Container.createSimpleBinaryExpression(result, idCheck, _core2.default.Expressions.ExpressionType.Or, \"||\", \"boolean\", orResolution);\n                } else {\n                    result = idCheck;\n                };\n            });\n            var temp = context.data;\n            context.data = '';\n            this.Visit(result, context);\n            context.data = temp + context.data.replace(/\\(/g, '').replace(/\\)/g, '');\n        } else {\n            this.Visit(expression.left, context);\n            context.data += \" \";\n            context.data += expression.resolution.mapTo;\n            context.data += \" \";\n            this.Visit(expression.right, context);\n        };\n        context.data += \")\";\n    },\n\n    VisitEntityFieldExpression: function VisitEntityFieldExpression(expression, context) {\n        this.Visit(expression.source, context);\n        if (expression.source instanceof _core2.default.Expressions.ComplexTypeExpression) {\n            context.data += \"/\";\n        }\n        this.Visit(expression.selector, context);\n    },\n\n    VisitAssociationInfoExpression: function VisitAssociationInfoExpression(expression, context) {\n        context.data += expression.associationInfo.FromPropertyName;\n    },\n\n    VisitMemberInfoExpression: function VisitMemberInfoExpression(expression, context) {\n        context.data += expression.memberName;\n    },\n\n    VisitQueryParameterExpression: function VisitQueryParameterExpression(expression, context) {\n        //context.data += this.provider.fieldConverter.toDb[expression.type](expression.value);\n\n        var typeName = _core.Container.resolveName(expression.type);\n\n        var converter = this.provider.fieldConverter.toDb[typeName];\n        var value = converter ? converter(expression.value) : expression.value;\n\n        converter = this.provider.fieldConverter.escape[typeName];\n        context.data += converter ? converter(value) : value;\n    },\n\n    VisitEntityFieldOperationExpression: function VisitEntityFieldOperationExpression(expression, context) {\n        _core.Guard.requireType(\"expression.operation\", expression.operation, _core2.default.Expressions.MemberInfoExpression);\n\n        //TODO refactor!\n        var opDef = expression.operation.memberDefinition;\n        var opName = opDef.mapTo || opDef.name;\n        context.data += opName;\n        context.data += \"(\";\n        var paramCounter = 0;\n        var params = opDef.parameters || [{ name: \"@expression\" }];\n\n        var args = params.map(function (item, index) {\n            if (item.name === \"@expression\") {\n                return expression.source;\n            } else {\n                return expression.parameters[paramCounter++];\n            };\n        });\n\n        args.forEach(function (arg, index) {\n            if (index > 0) {\n                context.data += \",\";\n            };\n            this.Visit(arg, context);\n        }, this);\n        context.data += \")\";\n    },\n\n    VisitConstantExpression: function VisitConstantExpression(expression, context) {\n        //var valueType = Container.getTypeName(expression.value);\n        //context.data += this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(expression.type))](expression.value);\n\n        var typeName = _core.Container.resolveName(expression.type);\n\n        var converter = this.provider.fieldConverter.toDb[typeName];\n        var value = converter ? converter(expression.value) : expression.value;\n\n        converter = this.provider.fieldConverter.escape[typeName];\n        context.data += converter ? converter(value) : value;\n    },\n\n    VisitEntityExpression: function VisitEntityExpression(expression, context) {\n        this.Visit(expression.source, context);\n\n        if (this.lambdaPrefix && expression.selector.lambda) {\n            context.lambda = expression.selector.lambda;\n            context.data += expression.selector.lambda + '/';\n        }\n\n        //if (expression.selector instanceof $data.Expressions.EntityExpression) {\n        //    this.Visit(expression.selector, context);\n        //}\n    },\n\n    VisitEntitySetExpression: function VisitEntitySetExpression(expression, context) {\n        this.Visit(expression.source, context);\n        if (expression.selector instanceof _core2.default.Expressions.AssociationInfoExpression) {\n            this.Visit(expression.selector, context);\n            context.data += \"/\";\n        }\n    },\n\n    VisitFrameOperationExpression: function VisitFrameOperationExpression(expression, context) {\n        this.Visit(expression.source, context);\n\n        _core.Guard.requireType(\"expression.operation\", expression.operation, _core2.default.Expressions.MemberInfoExpression);\n\n        //TODO refactor!\n        var opDef = expression.operation.memberDefinition;\n        var opName = opDef.mapTo || opDef.name;\n        context.data += opName;\n        context.data += \"(\";\n        var paramCounter = 0;\n        var params = opDef.parameters || [{ name: \"@expression\" }];\n\n        var args = params.map(function (item, index) {\n            if (item.name === \"@expression\") {\n                return expression.source;\n            } else {\n                return expression.parameters[paramCounter++];\n            };\n        });\n\n        for (var i = 0; i < args.length; i++) {\n            var arg = args[i];\n            if (arg && arg.value instanceof _core2.default.Queryable) {\n                var frameExpression = new opDef.frameType(arg.value.expression);\n                var preparator = _core.Container.createQueryExpressionCreator(arg.value.entityContext);\n                var prep_expression = preparator.Visit(frameExpression);\n\n                var compiler = new _core2.default.storageProviders.webApi.webApiWhereCompiler(this.provider, true);\n                var frameContext = { data: \"\" };\n                var compiled = compiler.compile(prep_expression, frameContext);\n\n                context.data += frameContext.lambda + ': ' + frameContext.data;\n            };\n        }\n        context.data += \")\";\n    }\n});\n\n(0, _core.$C)('$data.storageProviders.webApi.webApiOrderCompiler', _core2.default.storageProviders.webApi.webApiWhereCompiler, null, {\n    constructor: function constructor(provider) {\n        this.provider = provider;\n    },\n\n    compile: function compile(expression, context) {\n        this.Visit(expression, context);\n    },\n    VisitOrderExpression: function VisitOrderExpression(expression, context) {\n        var orderContext = { data: \"\" };\n        this.Visit(expression.selector, orderContext);\n        if (context['$orderby']) {\n            context['$orderby'] += ',';\n        } else {\n            context['$orderby'] = '';\n        }\n        context['$orderby'] += orderContext.data + (expression.nodeType == _core2.default.Expressions.ExpressionType.OrderByDescending ? \" desc\" : \"\");\n    },\n    VisitParametricQueryExpression: function VisitParametricQueryExpression(expression, context) {\n        this.Visit(expression.expression, context);\n    },\n    VisitEntityFieldExpression: function VisitEntityFieldExpression(expression, context) {\n        this.Visit(expression.source, context);\n        this.Visit(expression.selector, context);\n    },\n    VisitComplexTypeExpression: function VisitComplexTypeExpression(expression, context) {\n        this.Visit(expression.source, context);\n        this.Visit(expression.selector, context);\n        context.data += \"/\";\n    },\n    VisitEntitySetExpression: function VisitEntitySetExpression(expression, context) {\n        if (expression.selector instanceof _core2.default.Expressions.AssociationInfoExpression) {\n            this.Visit(expression.source, context);\n            this.Visit(expression.selector, context);\n        }\n    },\n    VisitAssociationInfoExpression: function VisitAssociationInfoExpression(expression, context) {\n        context.data += expression.associationInfo.FromPropertyName + '/';\n    },\n    VisitEntityExpression: function VisitEntityExpression(expression, context) {\n        this.Visit(expression.source, context);\n        this.Visit(expression.selector, context);\n    },\n    VisitMemberInfoExpression: function VisitMemberInfoExpression(expression, context) {\n        context.data += expression.memberName;\n    }\n});\n(0, _core.$C)('$data.storageProviders.webApi.webApiPagingCompiler', _core2.default.Expressions.EntityExpressionVisitor, null, {\n    constructor: function constructor(provider) {\n        this.provider = provider;\n    },\n\n    compile: function compile(expression, context) {\n        this.Visit(expression, context);\n    },\n    VisitPagingExpression: function VisitPagingExpression(expression, context) {\n        var pagingContext = { data: \"\" };\n        this.Visit(expression.amount, pagingContext);\n        switch (expression.nodeType) {\n            case _core2.default.Expressions.ExpressionType.Skip:\n                context['$skip'] = pagingContext.data;break;\n            case _core2.default.Expressions.ExpressionType.Take:\n                context['$top'] = pagingContext.data;break;\n            default:\n                _core.Guard.raise(\"Not supported nodeType\");break;\n        }\n    },\n    VisitConstantExpression: function VisitConstantExpression(expression, context) {\n        context.data += expression.value;\n    }\n});\n(0, _core.$C)('$data.storageProviders.webApi.webApiProjectionCompiler', _core2.default.Expressions.EntityExpressionVisitor, null, {\n    constructor: function constructor(entityContext) {\n        this.entityContext = entityContext;\n        this.hasObjectLiteral = false;\n        this.ObjectLiteralPath = \"\";\n        this.modelBinderMapping = [];\n    },\n\n    compile: function compile(expression, context) {\n        this.Visit(expression, context);\n    },\n    VisitProjectionExpression: function VisitProjectionExpression(expression, context) {\n        ///<summary></summary>\n        ///<param name=\"expression\" type=\"$data.Expressions.ProjectionExpression\" mayBeNull=\"false\"></param>\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\n        context.data = \"\";\n        this.mapping = \"\";\n\n        this.Visit(expression.selector, context);\n        if (context['$select']) {\n            context['$select'] += ',';\n        } else {\n            context['$select'] = '';\n        }\n        context[\"$select\"] += context.data;\n        context.data = \"\";\n    },\n    VisitParametricQueryExpression: function VisitParametricQueryExpression(expression, context) {\n        this.Visit(expression.expression, context);\n        if (expression.expression instanceof _core2.default.Expressions.EntityExpression || expression.expression instanceof _core2.default.Expressions.EntitySetExpression) {\n            if (context['$expand']) {\n                context['$expand'] += ',';\n            } else {\n                context['$expand'] = '';\n            }\n            context['$expand'] += this.mapping.replace(/\\./g, '/');\n        }if (expression.expression instanceof _core2.default.Expressions.ComplexTypeExpression) {\n            var m = this.mapping.split('.');\n            m.pop();\n            if (m.length > 0) {\n                if (context['$expand']) {\n                    context['$expand'] += ',';\n                } else {\n                    context['$expand'] = '';\n                }\n                context['$expand'] += m.join('/');\n            }\n        } else {\n            var m = this.mapping.split('.');\n            m.pop();\n            if (m.length > 0) {\n                if (context['$expand']) {\n                    context['$expand'] += ',';\n                } else {\n                    context['$expand'] = '';\n                }\n                context['$expand'] += m.join('/');\n            }\n        }\n    },\n    VisitObjectLiteralExpression: function VisitObjectLiteralExpression(expression, context) {\n        ///<summary></summary>\n        ///<param name=\"expression\" type=\"$data.Expressions.ObjectLiteralExpression\" mayBeNull=\"false\"></param>\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\n        var tempObjectLiteralPath = this.ObjectLiteralPath;\n        this.hasObjectLiteral = true;\n        expression.members.forEach(function (member, index) {\n            this.Visit(member, context);\n            if (index < expression.members.length - 1) {\n                context.data += ',';\n            }\n            this.mapping = '';\n        }, this);\n        this.ObjectLiteralPath = tempObjectLiteralPath;\n    },\n    VisitObjectFieldExpression: function VisitObjectFieldExpression(expression, context) {\n\n        if (this.ObjectLiteralPath) {\n            this.ObjectLiteralPath += '.' + expression.fieldName;\n        } else {\n            this.ObjectLiteralPath = expression.fieldName;\n        }\n        this.Visit(expression.expression, context);\n\n        if (expression.expression instanceof _core2.default.Expressions.EntityExpression || expression.expression instanceof _core2.default.Expressions.EntitySetExpression) {\n            if (context['$expand']) {\n                context['$expand'] += ',';\n            } else {\n                context['$expand'] = '';\n            }\n            context['$expand'] += this.mapping.replace(/\\./g, '/');\n        } else {\n            var m = this.mapping.split('.');\n            m.pop();\n            if (m.length > 0) {\n                if (context['$expand']) {\n                    context['$expand'] += ',';\n                } else {\n                    context['$expand'] = '';\n                }\n                context['$expand'] += m.join('/');\n            }\n        }\n    },\n\n    VisitComplexTypeExpression: function VisitComplexTypeExpression(expression, context) {\n        this.Visit(expression.source, context);\n        this.Visit(expression.selector, context);\n    },\n\n    VisitEntityFieldExpression: function VisitEntityFieldExpression(expression, context) {\n        this.Visit(expression.source, context);\n        this.Visit(expression.selector, context);\n    },\n    VisitEntityExpression: function VisitEntityExpression(expression, context) {\n        ///<summary></summary>\n        ///<param name=\"expression\" type=\"$data.Expressions.EntityExpression\" mayBeNull=\"false\"></param>\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\n        this.Visit(expression.source, context);\n    },\n    VisitEntitySetExpression: function VisitEntitySetExpression(expression, context) {\n        ///<summary></summary>\n        ///<param name=\"expression\" type=\"$data.Expressions.EntitySetExpression\" mayBeNull=\"false\"></param>\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\n        if (expression.source instanceof _core2.default.Expressions.EntityExpression) {\n            this.Visit(expression.source, context);\n        }\n        if (expression.selector instanceof _core2.default.Expressions.AssociationInfoExpression) {\n            this.Visit(expression.selector, context);\n        }\n    },\n    VisitAssociationInfoExpression: function VisitAssociationInfoExpression(expression, context) {\n        if (context.data && context.data.length > 0 && context.data[context.data.length - 1] != ',') {\n            context.data += '/';\n        }\n        context.data += expression.associationInfo.FromPropertyName;\n        if (this.mapping && this.mapping.length > 0) {\n            this.mapping += '.';\n        }\n        this.mapping += expression.associationInfo.FromPropertyName;\n    },\n    VisitMemberInfoExpression: function VisitMemberInfoExpression(expression, context) {\n        if (context.data && context.data.length > 0 && context.data[context.data.length - 1] != ',') {\n            context.data += '/';\n        }\n        context.data += expression.memberName;\n        if (this.mapping && this.mapping.length > 0) {\n            this.mapping += '.';\n        }\n        this.mapping += expression.memberName;\n    },\n    VisitConstantExpression: function VisitConstantExpression(expression, context) {\n        //Guard.raise(new Exception('Constant value is not supported in Projection.', 'Not supported!'));\n        //context.data += expression.value;\n        context.data = context.data.slice(0, context.data.length - 1);\n    }\n});\n\n},{\"jaydata/core\":\"jaydata/core\"}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _core = require('jaydata/core');\n\nvar _core2 = _interopRequireDefault(_core);\n\nvar _WebApiConverter = require('./WebApiConverter.js');\n\nvar _WebApiConverter2 = _interopRequireDefault(_WebApiConverter);\n\nvar _WebApiProvider = require('./WebApiProvider.js');\n\nvar _WebApiProvider2 = _interopRequireDefault(_WebApiProvider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _core2.default;\nmodule.exports = exports['default'];\n\n},{\"./WebApiConverter.js\":1,\"./WebApiProvider.js\":2,\"jaydata/core\":\"jaydata/core\"}]},{},[3])(3)\n});\n\n\t});\r\n})();\r\n","import $data, { $C, Guard, Container, Exception, MemberDefinition } from 'jaydata/core';\r\n\r\n$data.WebApiConverter = {\r\n    fromDb: {\r\n        '$data.Byte': $data.Container.proxyConverter,\r\n        '$data.SByte': $data.Container.proxyConverter,\r\n        '$data.Decimal': $data.Container.proxyConverter,\r\n        '$data.Float': $data.Container.proxyConverter,\r\n        '$data.Int16': $data.Container.proxyConverter,\r\n        '$data.Int64': $data.Container.proxyConverter,\r\n\r\n        '$data.Integer': $data.Container.proxyConverter,//function (number) { return (typeof number === 'string' && /^\\d+$/.test(number)) ? parseInt(number) : number; },\r\n        '$data.Int32': $data.Container.proxyConverter,\r\n        '$data.Number': $data.Container.proxyConverter,\r\n        '$data.Date': function (dbData) {\r\n            if (dbData) {\r\n                if (dbData instanceof Date) {\r\n                    return dbData;\r\n                } else if (dbData.substring(0, 6) === '/Date(') {\r\n                    return new Date(parseInt(dbData.substr(6)));\r\n                } else {\r\n                    //ISODate without Z? Safari compatible with Z\r\n                    if (dbData.indexOf('Z') === -1 && !dbData.match('T.*[+-]'))\r\n                        dbData += 'Z';\r\n                    return new Date(dbData);\r\n                }\r\n            } else {\r\n                return dbData;\r\n            }\r\n        },\r\n        '$data.DateTimeOffset': function (dbData) {\r\n            if (dbData) {\r\n                if (dbData instanceof Date) {\r\n                    return dbData;\r\n                } else if (dbData.substring(0, 6) === '/Date(') {\r\n                    return new Date(parseInt(dbData.substr(6)));\r\n                } else {\r\n                    //ISODate without Z? Safari compatible with Z\r\n                    if (dbData.indexOf('Z') === -1 && !dbData.match('T.*[+-]'))\r\n                        dbData += 'Z';\r\n                    return new Date(dbData);\r\n                }\r\n            } else {\r\n                return dbData;\r\n            }\r\n        },\r\n        '$data.Time': $data.Container.proxyConverter,\r\n        '$data.String': $data.Container.proxyConverter,\r\n        '$data.Boolean': $data.Container.proxyConverter,\r\n        '$data.Blob': function (v) {\r\n            if (typeof v == 'string') {\r\n                try { return $data.Container.convertTo(atob(v), '$data.Blob'); }\r\n                catch (e) { return v; }\r\n            } else return v;\r\n        },\r\n        '$data.Object': function (o) { if (o === undefined) { return new $data.Object(); } else if (typeof o === 'string') { return JSON.parse(o); } return o; },\r\n        '$data.Array': function (o) { if (o === undefined) { return new $data.Array(); } else if (o instanceof $data.Array) { return o; } return JSON.parse(o); },\r\n        '$data.GeographyPoint': function (geo) {\r\n            if (geo && typeof geo === 'object' && Array.isArray(geo.coordinates)) {\r\n                return new $data.GeographyPoint(geo.coordinates);\r\n            }\r\n            return geo;\r\n        },\r\n        '$data.Guid': function (guid) { return guid ? guid.toString() : guid; }\r\n    },\r\n    toDb: {\r\n        '$data.Entity': $data.Container.proxyConverter,\r\n        '$data.Byte': $data.Container.proxyConverter,\r\n        '$data.SByte': $data.Container.proxyConverter,\r\n        '$data.Decimal': $data.Container.proxyConverter,\r\n        '$data.Float': $data.Container.proxyConverter,\r\n        '$data.Int16': $data.Container.proxyConverter,\r\n        '$data.Int64': $data.Container.proxyConverter,\r\n        '$data.ObjectID': $data.Container.proxyConverter,\r\n        '$data.Integer': $data.Container.proxyConverter,\r\n        '$data.Int32': $data.Container.proxyConverter,\r\n        '$data.Number': $data.Container.proxyConverter,\r\n        '$data.Date': function (e) { return e ? e.toISOString().replace('Z', '') : e; },\r\n        '$data.Time': $data.Container.proxyConverter,\r\n        '$data.DateTimeOffset': function (v) { return v ? v.toISOString() : v; },\r\n        '$data.String': $data.Container.proxyConverter,\r\n        '$data.Boolean': $data.Container.proxyConverter,\r\n        '$data.Blob': function (v) { return v ? $data.Blob.toBase64(v) : v; },\r\n        '$data.Object': $data.Container.proxyConverter,\r\n        '$data.Array': $data.Container.proxyConverter,\r\n        '$data.GeographyPoint': $data.Container.proxyConverter,\r\n        '$data.Guid': $data.Container.proxyConverter\r\n    },\r\n    escape: {\r\n        '$data.Entity': function (e) { return JSON.stringify(e); },\r\n        '$data.Integer': $data.Container.proxyConverter,\r\n        '$data.Int32': $data.Container.proxyConverter,\r\n        '$data.Number': $data.Container.proxyConverter, // double: 13.5D\r\n        '$data.Int16': $data.Container.proxyConverter,\r\n        '$data.Byte': $data.Container.proxyConverter,\r\n        '$data.SByte': $data.Container.proxyConverter,\r\n        '$data.Decimal': function (v) { return v ? v + 'm' : v; },\r\n        '$data.Float': function (v) { return v ? v + 'f' : v; },\r\n        '$data.Int64': function (v) { return v ? v + 'L' : v; },\r\n        '$data.Time': function (v) { return v ? \"time'\" + v + \"'\" : v; },\r\n        '$data.DateTimeOffset': function (date) { return date ? \"datetimeoffset'\" + date + \"'\" : date; },\r\n        '$data.Date': function (date) { return date ? \"datetime'\" + date + \"'\" : date; },\r\n        '$data.String': function (text) { return typeof text === 'string' ? \"'\" + text.replace(/'/g, \"''\") + \"'\" : text; },\r\n        '$data.ObjectID': function (text) { return typeof text === 'string' ? \"'\" + text.replace(/'/g, \"''\") + \"'\" : text; },\r\n        '$data.Boolean': function (bool) { return typeof bool === 'boolean' ? bool.toString() : bool; },\r\n        '$data.Blob': function (b) { return b ? \"X'\" + $data.Blob.toHexString($data.Container.convertTo(atob(b), $data.Blob)) + \"'\" : b; },\r\n        '$data.Object': function (o) { return JSON.stringify(o); },\r\n        '$data.Array': function (o) { return JSON.stringify(o); },\r\n        '$data.GeographyPoint': function (g) { if (g) { return $data.GeographyBase.stringifyToUrl(g); } return g; },\r\n        '$data.Guid': function (guid) { return guid ? (\"guid'\" + guid.toString() + \"'\") : guid; }\r\n    }\r\n};\r\n","import $data, { $C, Guard, Container, Exception, MemberDefinition } from 'jaydata/core';\r\n\r\n$C('$data.Expressions.ExpressionWalker', $data.Expressions.EntityExpressionVisitor, null, {\r\n    constructor: function (monitorDefinition) {\r\n        this.Visit = function (expression, context) {\r\n\r\n            var result = expression;\r\n            var methodName;\r\n            if (this.canVisit(expression)) {\r\n\r\n                //if (monitorDefinition.FilterExpressionNode) {\r\n\r\n                //};\r\n\r\n                if (monitorDefinition.VisitExpressionNode) {\r\n                    monitorDefinition.VisitExpressionNode.apply(monitorDefinition, arguments);\r\n                };\r\n\r\n                methodName = \"Visit\" + expression.getType().name;\r\n                if (methodName in monitorDefinition) {\r\n                    result = monitorDefinition[methodName].apply(monitorDefinition, arguments);\r\n                }\r\n            }\r\n\r\n\r\n            //apply is about 3-4 times faster then call on webkit\r\n\r\n            var args = arguments;\r\n            if (result !== expression) args = [result, context];\r\n            result = $data.Expressions.EntityExpressionVisitor.prototype.Visit.apply(this, args);\r\n\r\n            args = [result, context];\r\n\r\n            if (this.canVisit(result)) {\r\n                var expressionTypeName = result.getType().name;\r\n                if (monitorDefinition.MonitorExpressionNode) {\r\n                    monitorDefinition.MonitorExpressionNode.apply(monitorDefinition, args);\r\n                }\r\n                methodName = \"Monitor\" + expressionTypeName;\r\n                if (methodName in monitorDefinition) {\r\n                    monitorDefinition[methodName].apply(monitorDefinition, args);\r\n                }\r\n\r\n                if (monitorDefinition.MutateExpressionNode) {\r\n                    monitorDefinition.MutateExpressionNode.apply(monitorDefinition, args);\r\n                }\r\n                methodName = \"Mutate\" + expressionTypeName;\r\n                if (methodName in monitorDefinition) {\r\n                    result = monitorDefinition[methodName].apply(monitorDefinition, args);\r\n                }\r\n\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n});\r\n$data.Expressions.ExpressionNode.prototype.walk = function (monitorDefinition, context) {\r\n    var m = Container.createExpressionWalker(monitorDefinition);\r\n    return m.Visit(this, context);\r\n};\r\n\r\n$data.Expressions.ExpressionNode.prototype.dig = function (predicate) {\r\n    var result = [];\r\n    this.walk({\r\n        MonitorExpressionNode: function (exp) {\r\n            var value;\r\n            if (value = predicate(exp)) {\r\n                result.push(value);\r\n            }\r\n        }\r\n    });\r\n    return result;\r\n}\r\n\r\n$C('$data.storageProviders.webApi.webApiProvider', $data.StorageProviderBase, null,\r\n{\r\n    constructor: function (cfg, ctx) {\r\n        this.context = ctx;\r\n        this.providerConfiguration = $data.typeSystem.extend({\r\n            dbCreation: $data.storageProviders.DbCreationType.DropTableIfChanged,\r\n            apiUrl: \"/odata.svc\",\r\n            serviceUrl: \"\",\r\n            maxDataServiceVersion: '2.0',\r\n            user: null,\r\n            password: null,\r\n            withCredentials: false,\r\n            enableJSONP: false\r\n            //disableBatch: undefined\r\n        }, cfg);\r\n        if (this.context && this.context._buildDbType_generateConvertToFunction && this.buildDbType_generateConvertToFunction) {\r\n            this.context._buildDbType_generateConvertToFunction = this.buildDbType_generateConvertToFunction;\r\n        }\r\n        if (this.context && this.context._buildDbType_modifyInstanceDefinition && this.buildDbType_modifyInstanceDefinition) {\r\n            this.context._buildDbType_modifyInstanceDefinition = this.buildDbType_modifyInstanceDefinition;\r\n        }\r\n    },\r\n    initializeStore: function (callBack) {\r\n        callBack = $data.typeSystem.createCallbackSetting(callBack);\r\n        callBack.success(this.context);\r\n    },\r\n    buildDbType_generateConvertToFunction: function (storageModel, context) {\r\n        return function (logicalEntity, convertedItems) {\r\n            var dbInstance = new storageModel.PhysicalType();\r\n            dbInstance.entityState = logicalEntity.entityState;\r\n\r\n            storageModel.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function (property) {\r\n                dbInstance.initData[property.name] = logicalEntity[property.name];\r\n            }, this);\r\n\r\n            if (storageModel.Associations) {\r\n                storageModel.Associations.forEach(function (association) {\r\n                    if ((association.FromMultiplicity == \"*\" && association.ToMultiplicity == \"0..1\") ||\r\n                        (association.FromMultiplicity == \"0..1\" && association.ToMultiplicity == \"1\") ||\r\n                        (association.FromMultiplicity == '$$unbound')) {\r\n                        var refValue = logicalEntity[association.FromPropertyName];\r\n                        if (refValue !== null && refValue !== undefined) {\r\n                            if (refValue instanceof $data.Array) {\r\n                                dbInstance.initData[association.FromPropertyName] = dbInstance[association.FromPropertyName] || [];\r\n                                refValue.forEach(function (rv) {\r\n                                    var contentId = convertedItems.indexOf(rv);\r\n                                    if (contentId < 0) { Guard.raise(\"Dependency graph error\"); }\r\n                                    dbInstance.initData[association.FromPropertyName].push({ __metadata: { uri: \"$\" + (contentId + 1) } });\r\n                                }, this);\r\n                            } else {\r\n                                if (refValue.entityState === $data.EntityState.Modified) {\r\n                                    var sMod = context._storageModel.getStorageModel(refValue.getType())\r\n                                    var tblName = sMod.TableName;\r\n                                    var pk = '(' + context.storageProvider.getEntityKeysValue({ data: refValue, entitySet: context.getEntitySetFromElementType(refValue.getType()) }) + ')';\r\n                                    dbInstance.initData[association.FromPropertyName] = { __metadata: { uri: tblName + pk } };\r\n                                } else {\r\n                                    var contentId = convertedItems.indexOf(refValue);\r\n                                    if (contentId < 0) { Guard.raise(\"Dependency graph error\"); }\r\n                                    dbInstance.initData[association.FromPropertyName] = { __metadata: { uri: \"$\" + (contentId + 1) } };\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }, this);\r\n            }\r\n            if (storageModel.ComplexTypes) {\r\n                storageModel.ComplexTypes.forEach(function (cmpType) {\r\n                    dbInstance.initData[cmpType.FromPropertyName] = logicalEntity[cmpType.FromPropertyName];\r\n                }, this);\r\n            }\r\n            return dbInstance;\r\n        };\r\n    },\r\n    buildDbType_modifyInstanceDefinition: function () { return; },\r\n    executeQuery: function (query, callBack) {\r\n        callBack = $data.typeSystem.createCallbackSetting(callBack);\r\n\r\n\r\n        var result;\r\n        try {\r\n            result = this._compile(query);\r\n        } catch (e) {\r\n            callBack.error(e);\r\n            return;\r\n        }\r\n        var schema = this.context;\r\n        //console.dir(expressionTree);\r\n        //console.log(query.expression.walk);\r\n        function checkForRead(query) {\r\n\r\n            var ex = $data.Expressions;\r\n            var bincount = 0;\r\n            var eqbins = query.expression.dig(function (exp) {\r\n                if (exp instanceof ex.SimpleBinaryExpression) {\r\n                    bincount++;\r\n                }\r\n                if (exp.nodeType == \"equal\") {\r\n                    var constExp = null;\r\n                    var fieldExp = null;\r\n                    if (exp.left instanceof ex.ConstantExpression) constExp = exp.left;\r\n                    if (exp.left instanceof ex.EntityFieldExpression) fieldExp = exp.left;\r\n                    if (exp.right instanceof ex.ConstantExpression) constExp = exp.right;\r\n                    if (exp.right instanceof ex.EntityFieldExpression) fieldExp = exp.right;\r\n                    if (fieldExp && constExp) {\r\n\r\n                        if (fieldExp.source.entityType === query.defaultType &&\r\n                            fieldExp.selector.memberName == query.defaultType.memberDefinitions.getKeyProperties()[0].name\r\n                            ) {\r\n                            return constExp.value;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            if (bincount == 1 && eqbins.length == 1) {\r\n                result.queryText = \"/\" + query.context.getEntitySetFromElementType(query.defaultType).tableName + \"/\" + eqbins[0].toString();\r\n            };\r\n            //query.w\r\n        }\r\n        checkForRead(query);\r\n\r\n        var request = {\r\n            url: this.providerConfiguration.apiUrl + result.queryText,\r\n            type: result.method,\r\n            success: function (data) {\r\n                if (callBack.success) {\r\n                    query.rawDataList = typeof data === 'string' ? [{ cnt: data }] : data;\r\n                    callBack.success(query);\r\n                }\r\n            },\r\n            error: function () {\r\n                console.dir(arguments);\r\n                callBack.error(arguments);\r\n                //callBack.error(errorThrow || new Exception('Request failed', 'RequestError', arguments));\r\n            }\r\n        };\r\n\r\n        this.appendBasicAuth(request, this.providerConfiguration.user, this.providerConfiguration.password, this.providerConfiguration.withCredentials);\r\n\r\n        this.context.prepareRequest.call(this, request);\r\n        $data.ajax(request);\r\n    },\r\n    _compile: function (queryable, params) {\r\n        var compiler = new $data.storageProviders.webApi.webApiCompiler();\r\n        var compiled = compiler.compile(queryable);\r\n        return compiled;\r\n    },\r\n    saveChanges: function (callBack, changedItems) {\r\n        if (changedItems.length > 0) {\r\n            var independentBlocks = this.buildIndependentBlocks(changedItems);\r\n            this.saveInternal(independentBlocks, 0, callBack);\r\n        }\r\n        else {\r\n            callBack.success(0);\r\n        }\r\n    },\r\n    saveInternal: function (independentBlocks, index2, callBack) {\r\n        if ((this.providerConfiguration.disableBatch === true || (typeof $data.defaults === 'object' && $data.defaults.disableBatch === true))\r\n            && typeof this._saveRestMany === 'function')\r\n        {\r\n            this._saveRestMany(independentBlocks, index2, callBack);\r\n        } else {\r\n            if (independentBlocks.length > 1 || (independentBlocks.length == 1 && independentBlocks[0].length > 1)) {\r\n                this._saveBatch(independentBlocks, index2, callBack);\r\n            } else {\r\n                this._saveRest(independentBlocks, index2, callBack);\r\n            }\r\n        }\r\n    },\r\n    _saveRest: function (independentBlocks, index2, callBack) {\r\n        var batchRequests = [];\r\n        var convertedItem = [];\r\n        var request;\r\n        for (var index = 0; index < independentBlocks.length; index++) {\r\n            for (var i = 0; i < independentBlocks[index].length; i++) {\r\n                convertedItem.push(independentBlocks[index][i].data);\r\n                request = {\r\n                    url: this.providerConfiguration.apiUrl + '/',\r\n                    headers: {},\r\n                    contentType: \"application/json\",\r\n                    dataType: \"json\"\r\n                };\r\n\r\n                //request.headers = { \"Content-Id\": convertedItem.length };\r\n                switch (independentBlocks[index][i].data.entityState) {\r\n                    case $data.EntityState.Unchanged: continue; break;\r\n                    case $data.EntityState.Added:\r\n                        request.type = \"POST\";\r\n                        request.url += independentBlocks[index][i].entitySet.tableName;\r\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\r\n                        break;\r\n                    case $data.EntityState.Modified:\r\n                        request.type = \"PUT\";\r\n                        request.url += independentBlocks[index][i].entitySet.tableName;\r\n                        request.url += \"/\" + this.getEntityKeysValue(independentBlocks[index][i]);\r\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\r\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\r\n                        break;\r\n                    case $data.EntityState.Deleted:\r\n                        request.type = \"DELETE\";\r\n                        request.url += independentBlocks[index][i].entitySet.tableName;\r\n                        request.url += \"/\" + this.getEntityKeysValue(independentBlocks[index][i]);\r\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\r\n                        break;\r\n                    default: Guard.raise(new Exception(\"Not supported Entity state\"));\r\n                }\r\n                if (request.data) {\r\n                    request.data = JSON.stringify(request.data);\r\n                }\r\n                //batchRequests.push(request);\r\n            }\r\n        }\r\n        var that = this;\r\n\r\n        request.success = function (data, status, xhr) {\r\n            var arg = arguments;\r\n            var s = xhr.status;\r\n            if (s >= 200 && s < 300) {\r\n\r\n                if (data) {\r\n                    var item = convertedItem[0];\r\n                    item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\r\n                        var propType = Container.resolveType(memDef.type);\r\n                        if (memDef.computed || memDef.key || (!propType.isAssignableTo && !memDef.inverseProperty)) {\r\n                            //if (memDef.concurrencyMode === $data.ConcurrencyMode.Fixed) {\r\n                            //    item[memDef.name] = response.headers.ETag || response.headers.Etag;\r\n                            //} else {\r\n                            var converter = that.fieldConverter.fromDb[Container.resolveName(memDef.type)];\r\n                            item[memDef.name] = converter ? converter(data[memDef.name]) : data[memDef.name];\r\n                            //}\r\n                        }\r\n                    }, this);\r\n                }\r\n                //if (s == 204) {\r\n                //    //TODO versioning/ETag\r\n                //    if (response.headers.ETag || response.headers.Etag) {\r\n                //        var property = item.getType().memberDefinitions.getPublicMappedProperties().filter(function (memDef) { return memDef.concurrencyMode === $data.ConcurrencyMode.Fixed });\r\n                //        if (property && property[0]) {\r\n                //            item[property[0].name] = response.headers.ETag || response.headers.Etag;\r\n                //        }\r\n                //    }\r\n\r\n                //} else {\r\n                //    //its optional to send back content from webapi\r\n                //    if (data) {\r\n                //        //item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\r\n                //        //    if (memDef.computed || memDef.key) {\r\n                //        //        if (memDef.concurrencyMode === $data.ConcurrencyMode.Fixed) {\r\n                //        //            item[memDef.name] = response.headers.ETag || response.headers.Etag;\r\n                //        //        } else {\r\n                //        //            var converter = that.fieldConverter.fromDb[Container.resolveType(memDef.type)];\r\n                //        //            item[memDef.name] = converter ? converter(data[memDef.name]) : data[memDef.name];\r\n                //        //        }\r\n                //        //    }\r\n                //        //}, this);\r\n                //        //item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\r\n                //        //    var propType = Container.resolveType(memDef.type);\r\n                //        //    if (memDef.computed || memDef.key || (!propType.isAssignableTo && !memDef.inverseProperty)) {\r\n                //        //        if (memDef.concurrencyMode === $data.ConcurrencyMode.Fixed) {\r\n                //        //            item[memDef.name] = response.headers.ETag || response.headers.Etag;\r\n                //        //        } else {\r\n                //        //            var converter = that.fieldConverter.fromDb[Container.resolveName(memDef.type)];\r\n                //        //            item[memDef.name] = converter ? converter(data[memDef.name]) : data[memDef.name];\r\n                //        //        }\r\n                //        //    }\r\n                //        //}, this);\r\n                //    }\r\n                //}\r\n\r\n                if (callBack.success) {\r\n                    callBack.success(convertedItem.length);\r\n                }\r\n            } else {\r\n                callBack.error(response);\r\n            }\r\n\r\n        }\r\n        request.error = function (e) {\r\n            callBack.error(new Exception((e.response || {}).body, e.message, e));\r\n        }\r\n\r\n        this.appendBasicAuth(request, this.providerConfiguration.user, this.providerConfiguration.password, this.providerConfiguration.withCredentials);\r\n        //if (this.providerConfiguration.user) {\r\n        //    requestData[0].user = this.providerConfiguration.user;\r\n        //    requestData[0].password = this.providerConfiguration.password || \"\";\r\n        //}\r\n\r\n        this.context.prepareRequest.call(this, request);\r\n        $data.ajax(request);\r\n        //OData.request.apply(this, requestData);\r\n    },\r\n    _saveBatch: function (independentBlocks, index2, callBack) {\r\n        var batchRequests = [];\r\n        var convertedItem = [];\r\n        for (var index = 0; index < independentBlocks.length; index++) {\r\n            for (var i = 0; i < independentBlocks[index].length; i++) {\r\n                convertedItem.push(independentBlocks[index][i].data);\r\n                var request = {};\r\n                request.headers = { \"Content-Id\": convertedItem.length };\r\n                switch (independentBlocks[index][i].data.entityState) {\r\n                    case $data.EntityState.Unchanged: continue; break;\r\n                    case $data.EntityState.Added:\r\n                        request.method = \"POST\";\r\n                        request.requestUri = independentBlocks[index][i].entitySet.tableName;\r\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\r\n                        break;\r\n                    case $data.EntityState.Modified:\r\n                        request.method = \"MERGE\";\r\n                        request.requestUri = independentBlocks[index][i].entitySet.tableName;\r\n                        request.requestUri += \"(\" + this.getEntityKeysValue(independentBlocks[index][i]) + \")\";\r\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\r\n                        request.data = this.save_getInitData(independentBlocks[index][i], convertedItem);\r\n                        break;\r\n                    case $data.EntityState.Deleted:\r\n                        request.method = \"DELETE\";\r\n                        request.requestUri = independentBlocks[index][i].entitySet.tableName;\r\n                        request.requestUri += \"(\" + this.getEntityKeysValue(independentBlocks[index][i]) + \")\";\r\n                        this.save_addConcurrencyHeader(independentBlocks[index][i], request.headers);\r\n                        break;\r\n                    default: Guard.raise(new Exception(\"Not supported Entity state\"));\r\n                }\r\n                batchRequests.push(request);\r\n            }\r\n        }\r\n        var that = this;\r\n\r\n        var requestData = [{\r\n            requestUri: this.providerConfiguration.apiUrl + \"/$batch\",\r\n            method: \"POST\",\r\n            data: {\r\n                __batchRequests: [{ __changeRequests: batchRequests }]\r\n            }\r\n        }, function (data, response) {\r\n            if (response.statusCode == 202) {\r\n                var result = data.__batchResponses[0].__changeResponses;\r\n                var errors = [];\r\n\r\n                for (var i = 0; i < result.length; i++) {\r\n                    if (result[i].statusCode > 200 && result[i].statusCode < 300) {\r\n                        var item = convertedItem[i];\r\n                        if (result[i].statusCode == 204) {\r\n                            if (result[i].headers.ETag || result[i].headers.Etag || result[i].headers.etag) {\r\n                                var property = item.getType().memberDefinitions.getPublicMappedProperties().filter(function (memDef) { return memDef.concurrencyMode === $data.ConcurrencyMode.Fixed });\r\n                                if (property && property[0]) {\r\n                                    item[property[0].name] = result[i].headers.ETag || result[i].headers.Etag || result[i].headers.etag;\r\n                                }\r\n                            }\r\n                            continue;\r\n                        }\r\n\r\n                        item.getType().memberDefinitions.getPublicMappedProperties().forEach(function (memDef) {\r\n                            //TODO: is this correct?\r\n                            if (memDef.computed || memDef.key) {\r\n                                if (memDef.concurrencyMode === $data.ConcurrencyMode.Fixed) {\r\n                                    item[memDef.name] = result[i].headers.ETag || result[i].headers.Etag || result[i].headers.etag;\r\n                                } else {\r\n                                    var converter = that.fieldConverter.fromDb[Container.resolveType(memDef.type)];\r\n                                    item[memDef.name] = converter ? converter(result[i].data[memDef.name]) : result[i].data[memDef.name];\r\n                                }\r\n                            }\r\n                        }, this);\r\n\r\n                    } else {\r\n                        errors.push(new Exception((result[i].response || {}).body, result[i].message, result[i]));\r\n                    }\r\n                }\r\n                if (errors.length > 0) {\r\n                    callBack.error(new Exception('See inner exceptions', 'Batch failed', errors));\r\n                } else if (callBack.success) {\r\n                    callBack.success(convertedItem.length);\r\n                }\r\n            } else {\r\n                callBack.error(response);\r\n            }\r\n\r\n        }, function (e) {\r\n            callBack.error(new Exception((e.response || {}).body, e.message, e));\r\n        }, OData.batchHandler];\r\n\r\n        this.appendBasicAuth(requestData[0], this.providerConfiguration.user, this.providerConfiguration.password, this.providerConfiguration.withCredentials);\r\n        //if (this.providerConfiguration.user) {\r\n        //    requestData[0].user = this.providerConfiguration.user;\r\n        //    requestData[0].password = this.providerConfiguration.password || \"\";\r\n        //}\r\n\r\n        this.context.prepareRequest.call(this, requestData);\r\n        OData.request.apply(this, requestData);\r\n    },\r\n    save_getInitData: function (item, convertedItems) {\r\n        item.physicalData = this.context._storageModel.getStorageModel(item.data.getType()).PhysicalType.convertTo(item.data, convertedItems);\r\n        var serializableObject = {}\r\n        item.physicalData.getType().memberDefinitions.asArray().forEach(function (memdef) {\r\n            if (memdef.kind == $data.MemberTypes.navProperty ||\r\n                memdef.kind == $data.MemberTypes.complexProperty ||\r\n\r\n                (memdef.kind == $data.MemberTypes.property && !memdef.notMapped)) {\r\n                //if (typeof memdef.concurrencyMode === 'undefined' &&\r\n                //    (memdef.key === true || item.data.entityState === $data.EntityState.Added ||\r\n                //    item.data.changedProperties.some(function (def) { return def.name === memdef.name; }))\r\n                //)\r\n                serializableObject[memdef.name] = item.physicalData[memdef.name];\r\n            }\r\n        }, this);\r\n        return serializableObject;\r\n    },\r\n    save_addConcurrencyHeader: function (item, headers) {\r\n        var property = item.data.getType().memberDefinitions.getPublicMappedProperties().filter(function (memDef) { return memDef.concurrencyMode === $data.ConcurrencyMode.Fixed });\r\n        if (property && property[0]) {\r\n            headers['If-Match'] = item.data[property[0].name];\r\n            //item.data[property[0].name] = \"\";\r\n        }\r\n    },\r\n    getTraceString: function (queryable) {\r\n        var sqlText = this._compile(queryable);\r\n        return queryable;\r\n    },\r\n    supportedDataTypes: { value: [$data.Integer, $data.String, $data.Number, $data.Blob, $data.Boolean, $data.Date, $data.Object, $data.GeographyPoint, $data.Guid,\r\n        $data.Byte, $data.SByte, $data.Decimal, $data.Float, $data.Int16, $data.Int32, $data.Int64, $data.Time, $data.DateTimeOffset], writable: false },\r\n\r\n    supportedBinaryOperators: {\r\n        value: {\r\n            equal: { mapTo: 'eq', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            notEqual: { mapTo: 'ne', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            equalTyped: { mapTo: 'eq', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            notEqualTyped: { mapTo: 'ne', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            greaterThan: { mapTo: 'gt', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            greaterThanOrEqual: { mapTo: 'ge', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n\r\n            lessThan: { mapTo: 'lt', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            lessThenOrEqual: { mapTo: 'le', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            or: { mapTo: 'or', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            and: { mapTo: 'and', dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n\r\n            add: { mapTo: 'add', dataType: \"number\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            divide: { mapTo: 'div', allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            multiply: { mapTo: 'mul', allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            subtract: { mapTo: 'sub', allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n            modulo: { mapTo: 'mod', allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] },\r\n\r\n            \"in\": { mapTo: \"in\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression] }\r\n        }\r\n    },\r\n\r\n    supportedUnaryOperators: {\r\n        value: {\r\n            not: { mapTo: 'not' }\r\n        }\r\n    },\r\n\r\n    supportedFieldOperations: {\r\n        value: {\r\n            /* string functions */\r\n\r\n            contains: {\r\n                mapTo: \"substringof\",\r\n                dataType: \"boolean\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"substring\", dataType: \"string\" }, { name: \"@expression\" }]\r\n            },\r\n\r\n            startsWith: {\r\n                mapTo: \"startswith\",\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"strFragment\", dataType: \"string\" }]\r\n            },\r\n\r\n            endsWith: {\r\n                mapTo: \"endswith\",\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"strFragment\", dataType: \"string\" }]\r\n            },\r\n\r\n            length: {\r\n                dataType: \"number\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.ProjectionExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\r\n            },\r\n            strLength: {\r\n                mapTo: \"length\",\r\n                dataType: \"number\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.ProjectionExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\r\n            },\r\n\r\n            indexOf: {\r\n                dataType: \"number\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                mapTo: \"indexof\",\r\n                baseIndex: 1,\r\n                parameters: [{ name: '@expression', dataType: \"string\" }, { name: 'strFragment', dataType: 'string' }]\r\n            },\r\n\r\n            replace: {\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: '@expression', dataType: \"string\" }, { name: 'strFrom', dataType: 'string' }, { name: 'strTo', dataType: 'string' }]\r\n            },\r\n\r\n            substr: {\r\n                mapTo: \"substring\",\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"startFrom\", dataType: \"number\" }, { name: \"length\", dataType: \"number\", optional: \"true\" }]\r\n            },\r\n\r\n            toLowerCase: {\r\n                mapTo: \"tolower\",\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\r\n            },\r\n\r\n            toUpperCase: {\r\n                mapTo: \"toupper\",\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\r\n\r\n            },\r\n\r\n            trim: {\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }]\r\n            },\r\n\r\n\r\n            concat: {\r\n                dataType: \"string\", allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"string\" }, { name: \"strFragment\", dataType: \"string\" }]\r\n            },\r\n\r\n\r\n            /* data functions */\r\n\r\n            day: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n            hour: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n            minute: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n            month: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n            second: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n            year: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n\r\n            /* number functions */\r\n            round: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n            floor: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            },\r\n            ceiling: {\r\n                allowedIn: [$data.Expressions.FilterExpression, $data.Expressions.OrderExpression],\r\n                parameters: [{ name: \"@expression\", dataType: \"date\" }]\r\n            }\r\n        },\r\n        enumerable: true,\r\n        writable: true\r\n    },\r\n    supportedSetOperations: {\r\n        value: {\r\n            filter: {},\r\n            map: {},\r\n            length: {},\r\n            forEach: {},\r\n            toArray: {},\r\n            single: {},\r\n            some: {\r\n                invokable: false,\r\n                allowedIn: [$data.Expressions.FilterExpression],\r\n                parameters: [{ name: \"filter\", dataType: \"$data.Queryable\" }],\r\n                mapTo: 'any',\r\n                frameType: $data.Expressions.SomeExpression\r\n            },\r\n            every: {\r\n                invokable: false,\r\n                allowedIn: [$data.Expressions.FilterExpression],\r\n                parameters: [{ name: \"filter\", dataType: \"$data.Queryable\" }],\r\n                mapTo: 'all',\r\n                frameType: $data.Expressions.EveryExpression\r\n            },\r\n            take: {},\r\n            skip: {},\r\n            orderBy: {},\r\n            orderByDescending: {},\r\n            first: {},\r\n            include: {},\r\n            batchDelete: {}\r\n        },\r\n        enumerable: true,\r\n        writable: true\r\n    },\r\n    fieldConverter: { value: $data.WebApiConverter },\r\n    getEntityKeysValue: function (entity) {\r\n        var result = [];\r\n        var keyValue = undefined;\r\n\r\n        var memDefs = entity.entitySet.createNew.memberDefinitions.asArray();\r\n        for (var i = 0, l = memDefs.length; i < l; i++) {\r\n            var field = memDefs[i];\r\n            if (field.key) {\r\n                keyValue = entity.data[field.name];\r\n                switch (Container.getName(field.originalType)) {\r\n                    case \"$data.Guid\":\r\n                    case \"Edm.Guid\":\r\n                        keyValue = (\"guid'\" + (keyValue ? keyValue.value : keyValue) + \"'\");\r\n                        break;\r\n                    case \"$data.Blob\":\r\n                    case \"Edm.Binary\":\r\n                        keyValue = (\"binary'\" + keyValue + \"'\");\r\n                        break;\r\n                    case \"Edm.Byte\":\r\n                        var hexDigits = '0123456789ABCDEF';\r\n                        keyValue = (hexDigits[(i >> 4) & 15] + hexDigits[i & 15]);\r\n                        break;\r\n                    case \"$data.Date\":\r\n                    case \"Edm.DateTime\":\r\n                        keyValue = (\"datetime'\" + keyValue.toISOString() + \"'\");\r\n                        break;\r\n                    case \"Edm.Decimal\":\r\n                        keyValue = (keyValue + \"M\");\r\n                        break;\r\n                    case \"Edm.Single\":\r\n                        keyValue = (keyValue + \"f\");\r\n                        break;\r\n                    case \"Edm.Int64\":\r\n                        keyValue = (keyValue + \"L\");\r\n                        break;\r\n                    case 'Edm.String':\r\n                    case \"$data.String\":\r\n                        keyValue = (\"'\" + keyValue + \"'\");\r\n                        break;\r\n                }\r\n                result.push(field.name + \"=\" + keyValue);\r\n            }\r\n        }\r\n        if (result.length > 1) {\r\n            return result.join(\",\");\r\n        }\r\n        return keyValue;\r\n    },\r\n    appendBasicAuth: function (request, user, password, withCredentials) {\r\n        request.headers = request.headers || {};\r\n        if (!request.headers.Authorization && user && password) {\r\n            request.headers.Authorization = \"Basic \" + this.__encodeBase64(user + \":\" + password);\r\n            request.withCredentials = withCredentials;\r\n        }\r\n    },\r\n    __encodeBase64: function (val) {\r\n        var b64array = \"ABCDEFGHIJKLMNOP\" +\r\n                           \"QRSTUVWXYZabcdef\" +\r\n                           \"ghijklmnopqrstuv\" +\r\n                           \"wxyz0123456789+/\" +\r\n                           \"=\";\r\n\r\n        var input = val;\r\n        var base64 = \"\";\r\n        var hex = \"\";\r\n        var chr1, chr2, chr3 = \"\";\r\n        var enc1, enc2, enc3, enc4 = \"\";\r\n        var i = 0;\r\n\r\n        do {\r\n            chr1 = input.charCodeAt(i++);\r\n            chr2 = input.charCodeAt(i++);\r\n            chr3 = input.charCodeAt(i++);\r\n\r\n            enc1 = chr1 >> 2;\r\n            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n            enc4 = chr3 & 63;\r\n\r\n            if (isNaN(chr2)) {\r\n                enc3 = enc4 = 64;\r\n            } else if (isNaN(chr3)) {\r\n                enc4 = 64;\r\n            }\r\n\r\n            base64 = base64 +\r\n                        b64array.charAt(enc1) +\r\n                        b64array.charAt(enc2) +\r\n                        b64array.charAt(enc3) +\r\n                        b64array.charAt(enc4);\r\n            chr1 = chr2 = chr3 = \"\";\r\n            enc1 = enc2 = enc3 = enc4 = \"\";\r\n        } while (i < input.length);\r\n\r\n        return base64;\r\n    }\r\n}, null);\r\n\r\n$data.StorageProviderBase.registerProvider(\"webApi\", $data.storageProviders.webApi.webApiProvider);\r\n\r\n$C('$data.storageProviders.webApi.webApiCompiler', $data.Expressions.EntityExpressionVisitor, null, {\r\n    constructor: function () {\r\n        this.context = {};\r\n        this.provider = {};\r\n        //this.logicalType = null;\r\n        this.includes = null;\r\n        this.mainEntitySet = null;\r\n    },\r\n    compile: function (query) {\r\n\r\n        this.provider = query.context.storageProvider;\r\n        this.context = query.context;\r\n        this.mainEntitySet = query.context.getEntitySetFromElementType(query.defaultType);\r\n\r\n        var queryFragments = { urlText: \"\" };\r\n\r\n        this.Visit(query.expression, queryFragments);\r\n\r\n        query.modelBinderConfig = {};\r\n        var modelBinder = Container.createModelBinderConfigCompiler(query, this.includes, true);\r\n        modelBinder.Visit(query.expression);\r\n\r\n\r\n        var queryText = queryFragments.urlText;\r\n        var addAmp = false;\r\n        for (var name in queryFragments) {\r\n            if (name != \"urlText\" && name != \"actionPack\" && name != \"data\" && name != \"lambda\" && name != \"method\" && queryFragments[name] != \"\") {\r\n                if (addAmp) { queryText += \"&\"; } else { queryText += \"?\"; }\r\n                addAmp = true;\r\n                if (name != \"$urlParams\") {\r\n                    queryText += name + '=' + queryFragments[name];\r\n                } else {\r\n                    queryText += queryFragments[name];\r\n                }\r\n            }\r\n        }\r\n        query.queryText = queryText;\r\n\r\n        return {\r\n            queryText: queryText,\r\n            method: queryFragments.method || 'GET',\r\n            params: []\r\n        };\r\n    },\r\n    VisitOrderExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n\r\n        var orderCompiler = Container.createwebApiOrderCompiler(this.provider);\r\n        orderCompiler.compile(expression, context);\r\n    },\r\n    VisitPagingExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n\r\n        var pagingCompiler = Container.createwebApiPagingCompiler();\r\n        pagingCompiler.compile(expression, context);\r\n    },\r\n    VisitIncludeExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        if (!context['$select']) {\r\n            if (context['$expand']) { context['$expand'] += ','; } else { context['$expand'] = ''; }\r\n            context['$expand'] += expression.selector.value.replace(/\\./g, '/');\r\n\r\n            this.includes = this.includes || [];\r\n            var includeFragment = expression.selector.value.split('.');\r\n            var tempData = null;\r\n            var storageModel = this.mainEntitySet.entityContext._storageModel.getStorageModel(this.mainEntitySet.createNew);\r\n            for (var i = 0; i < includeFragment.length; i++) {\r\n                if (tempData) { tempData += '.' + includeFragment[i]; } else { tempData = includeFragment[i]; }\r\n                var association = storageModel.Associations[includeFragment[i]];\r\n                if (association) {\r\n                    if (!this.includes.some(function (include) { return include.name == tempData }, this)) {\r\n                        this.includes.push({ name: tempData, type: association.ToType });\r\n                    }\r\n                }\r\n                else {\r\n                    Guard.raise(new Exception(\"The given include path is invalid: \" + expression.selector.value + \", invalid point: \" + tempData));\r\n                }\r\n                storageModel = this.mainEntitySet.entityContext._storageModel.getStorageModel(association.ToType);\r\n            }\r\n        }\r\n    },\r\n    VisitProjectionExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n\r\n        var projectionCompiler = Container.createwebApiProjectionCompiler(this.context);\r\n        projectionCompiler.compile(expression, context);\r\n    },\r\n    VisitFilterExpression: function (expression, context) {\r\n        ///<param name=\"expression\" type=\"$data.Expressions.FilterExpression\" />\r\n\r\n        this.Visit(expression.source, context);\r\n\r\n        var filterCompiler = Container.createwebApiWhereCompiler(this.provider);\r\n        context.data = \"\";\r\n        filterCompiler.compile(expression.selector, context);\r\n        context[\"$filter\"] = context.data;\r\n        context.data = \"\";\r\n\r\n    },\r\n    VisitEntitySetExpression: function (expression, context) {\r\n        context.urlText += \"/\" + expression.instance.tableName;\r\n        //this.logicalType = expression.instance.elementType;\r\n        if (expression.params) {\r\n            for (var i = 0; i < expression.params.length; i++) {\r\n                this.Visit(expression.params[i], context);\r\n            }\r\n        }\r\n    },\r\n    VisitServiceOperationExpression: function (expression, context) {\r\n        context.urlText += \"/\" + expression.cfg.serviceName;\r\n        //this.logicalType = expression.returnType;\r\n        if (expression.params) {\r\n            for (var i = 0; i < expression.params.length; i++) {\r\n                this.Visit(expression.params[i], context);\r\n            }\r\n        }\r\n    },\r\n    VisitBatchDeleteExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        context.urlText += '/$batchDelete';\r\n        context.method = 'DELETE';\r\n    },\r\n\r\n    VisitConstantExpression: function (expression, context) {\r\n        if (context['$urlParams']) { context['$urlParams'] += '&'; } else { context['$urlParams'] = ''; }\r\n\r\n        var typeName = Container.resolveName(expression.type);\r\n        if (expression.value instanceof $data.Entity)\r\n            typeName = $data.Entity.fullName;\r\n\r\n        var converter = this.provider.fieldConverter.toDb[typeName];\r\n        var value = converter ? converter(expression.value) : expression.value;\r\n\r\n        converter = this.provider.fieldConverter.escape[typeName];\r\n        value = converter ? converter(value) : value;\r\n\r\n        /*var value;\r\n        if (expression.value instanceof $data.Entity) {\r\n            value = this.provider.fieldConverter.toDb['$data.Entity'](expression.value);\r\n        } else {\r\n            //var valueType = Container.getTypeName(expression.value);\r\n            value = this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(expression.type))](expression.value);\r\n        }*/\r\n        context['$urlParams'] += expression.name + '=' + value;\r\n    },\r\n    //    VisitConstantExpression: function (expression, context) {\r\n    //        if (context['$urlParams']) { context['$urlParams'] += '&'; } else { context['$urlParams'] = ''; }\r\n    //\r\n    //\r\n    //        var valueType = Container.getTypeName(expression.value);\r\n    //\r\n    //\r\n    //\r\n    //        context['$urlParams'] += expression.name + '=' + this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(valueType))](expression.value);\r\n    //    },\r\n\r\n\r\n    VisitCountExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        context.urlText += '/$count';\r\n    }\r\n}, {});\r\n\r\n$C('$data.storageProviders.webApi.webApiWhereCompiler', $data.Expressions.EntityExpressionVisitor, null, {\r\n    constructor: function (provider, lambdaPrefix) {\r\n        this.provider = provider;\r\n        this.lambdaPrefix = lambdaPrefix;\r\n    },\r\n\r\n    compile: function (expression, context) {\r\n        this.Visit(expression, context);\r\n    },\r\n\r\n    VisitParametricQueryExpression: function (expression, context) {\r\n        this.Visit(expression.expression, context);\r\n    },\r\n\r\n    VisitUnaryExpression: function (expression, context) {\r\n        context.data += expression.resolution.mapTo;\r\n        context.data += \"(\";\r\n        this.Visit(expression.operand, context);\r\n        context.data += \")\";\r\n    },\r\n\r\n\r\n    VisitSimpleBinaryExpression: function (expression, context) {\r\n        context.data += \"(\";\r\n        //TODO refactor!!!\r\n        if (expression.nodeType == \"in\") {\r\n            Guard.requireType(\"expression.right\", expression.type, $data.Expressions.ConstantExpression);\r\n            var paramValue = expression.right.value;\r\n            if (!(paramValue instanceof Array)) { Guard.raise(new Exception(\"Right to the 'in' operator must be an array value\")); }\r\n            var result = null;\r\n            var orResolution = { mapTo: \"or\", dataType: \"boolean\", name: \"or\" };\r\n            var eqResolution = { mapTo: \"eq\", dataType: \"boolean\", name: \"equal\" };\r\n\r\n            paramValue.forEach(function (item) {\r\n                var idValue = item;\r\n                var idCheck = Container.createSimpleBinaryExpression(expression.left, idValue,\r\n                    $data.Expressions.ExpressionType.Equal, \"==\", \"boolean\", eqResolution);\r\n                if (result) {\r\n                    result = Container.createSimpleBinaryExpression(result, idCheck,\r\n                    $data.Expressions.ExpressionType.Or, \"||\", \"boolean\", orResolution);\r\n                } else {\r\n                    result = idCheck;\r\n                };\r\n\r\n            });\r\n            var temp = context.data;\r\n            context.data = '';\r\n            this.Visit(result, context);\r\n            context.data = temp + context.data.replace(/\\(/g, '').replace(/\\)/g, '');\r\n        } else {\r\n            this.Visit(expression.left, context);\r\n            context.data += \" \";\r\n            context.data += expression.resolution.mapTo;\r\n            context.data += \" \";\r\n            this.Visit(expression.right, context);\r\n        };\r\n        context.data += \")\";\r\n\r\n    },\r\n\r\n    VisitEntityFieldExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        if (expression.source instanceof $data.Expressions.ComplexTypeExpression) {\r\n            context.data += \"/\";\r\n        }\r\n        this.Visit(expression.selector, context);\r\n    },\r\n\r\n    VisitAssociationInfoExpression: function (expression, context) {\r\n        context.data += expression.associationInfo.FromPropertyName;\r\n    },\r\n\r\n    VisitMemberInfoExpression: function (expression, context) {\r\n        context.data += expression.memberName;\r\n    },\r\n\r\n    VisitQueryParameterExpression: function (expression, context) {\r\n        //context.data += this.provider.fieldConverter.toDb[expression.type](expression.value);\r\n\r\n        var typeName = Container.resolveName(expression.type);\r\n\r\n        var converter = this.provider.fieldConverter.toDb[typeName];\r\n        var value = converter ? converter(expression.value) : expression.value;\r\n\r\n        converter = this.provider.fieldConverter.escape[typeName];\r\n        context.data += converter ? converter(value) : value;\r\n    },\r\n\r\n    VisitEntityFieldOperationExpression: function (expression, context) {\r\n        Guard.requireType(\"expression.operation\", expression.operation, $data.Expressions.MemberInfoExpression);\r\n\r\n        //TODO refactor!\r\n        var opDef = expression.operation.memberDefinition;\r\n        var opName = opDef.mapTo || opDef.name;\r\n        context.data += opName;\r\n        context.data += \"(\";\r\n        var paramCounter = 0;\r\n        var params = opDef.parameters || [{ name: \"@expression\" }];\r\n\r\n        var args = params.map(function (item, index) {\r\n            if (item.name === \"@expression\") {\r\n                return expression.source;\r\n            } else {\r\n                return expression.parameters[paramCounter++]\r\n            };\r\n        });\r\n\r\n        args.forEach(function (arg, index) {\r\n            if (index > 0) {\r\n                context.data += \",\";\r\n            };\r\n            this.Visit(arg, context);\r\n        }, this);\r\n        context.data += \")\";\r\n    },\r\n\r\n    VisitConstantExpression: function (expression, context) {\r\n        //var valueType = Container.getTypeName(expression.value);\r\n        //context.data += this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(expression.type))](expression.value);\r\n\r\n        var typeName = Container.resolveName(expression.type);\r\n\r\n        var converter = this.provider.fieldConverter.toDb[typeName];\r\n        var value = converter ? converter(expression.value) : expression.value;\r\n\r\n        converter = this.provider.fieldConverter.escape[typeName];\r\n        context.data += converter ? converter(value) : value;\r\n    },\r\n\r\n    VisitEntityExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n\r\n        if (this.lambdaPrefix && expression.selector.lambda) {\r\n            context.lambda = expression.selector.lambda;\r\n            context.data += (expression.selector.lambda + '/');\r\n        }\r\n\r\n        //if (expression.selector instanceof $data.Expressions.EntityExpression) {\r\n        //    this.Visit(expression.selector, context);\r\n        //}\r\n    },\r\n\r\n    VisitEntitySetExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        if (expression.selector instanceof $data.Expressions.AssociationInfoExpression) {\r\n            this.Visit(expression.selector, context);\r\n            context.data += \"/\";\r\n        }\r\n    },\r\n\r\n    VisitFrameOperationExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n\r\n        Guard.requireType(\"expression.operation\", expression.operation, $data.Expressions.MemberInfoExpression);\r\n\r\n        //TODO refactor!\r\n        var opDef = expression.operation.memberDefinition;\r\n        var opName = opDef.mapTo || opDef.name;\r\n        context.data += opName;\r\n        context.data += \"(\";\r\n        var paramCounter = 0;\r\n        var params = opDef.parameters || [{ name: \"@expression\" }];\r\n\r\n        var args = params.map(function (item, index) {\r\n            if (item.name === \"@expression\") {\r\n                return expression.source;\r\n            } else {\r\n                return expression.parameters[paramCounter++]\r\n            };\r\n        });\r\n\r\n        for (var i = 0; i < args.length; i++) {\r\n            var arg = args[i];\r\n            if (arg && arg.value instanceof $data.Queryable) {\r\n                var frameExpression = new opDef.frameType(arg.value.expression);\r\n                var preparator = Container.createQueryExpressionCreator(arg.value.entityContext);\r\n                var prep_expression = preparator.Visit(frameExpression);\r\n\r\n                var compiler = new $data.storageProviders.webApi.webApiWhereCompiler(this.provider, true);\r\n                var frameContext = { data: \"\" };\r\n                var compiled = compiler.compile(prep_expression, frameContext);\r\n\r\n                context.data += (frameContext.lambda + ': ' + frameContext.data);\r\n            };\r\n        }\r\n        context.data += \")\";\r\n    }\r\n});\r\n\r\n$C('$data.storageProviders.webApi.webApiOrderCompiler', $data.storageProviders.webApi.webApiWhereCompiler, null, {\r\n    constructor: function (provider) {\r\n        this.provider = provider;\r\n    },\r\n\r\n    compile: function (expression, context) {\r\n        this.Visit(expression, context);\r\n    },\r\n    VisitOrderExpression: function (expression, context) {\r\n        var orderContext = { data: \"\" };\r\n        this.Visit(expression.selector, orderContext);\r\n        if (context['$orderby']) { context['$orderby'] += ','; } else { context['$orderby'] = ''; }\r\n        context['$orderby'] += orderContext.data\r\n                           + (expression.nodeType == $data.Expressions.ExpressionType.OrderByDescending ? \" desc\" : \"\");\r\n    },\r\n    VisitParametricQueryExpression: function (expression, context) {\r\n        this.Visit(expression.expression, context);\r\n    },\r\n    VisitEntityFieldExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        this.Visit(expression.selector, context);\r\n    },\r\n    VisitComplexTypeExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        this.Visit(expression.selector, context);\r\n        context.data += \"/\";\r\n    },\r\n    VisitEntitySetExpression: function (expression, context) {\r\n        if (expression.selector instanceof $data.Expressions.AssociationInfoExpression) {\r\n            this.Visit(expression.source, context);\r\n            this.Visit(expression.selector, context);\r\n        }\r\n    },\r\n    VisitAssociationInfoExpression: function (expression, context) {\r\n        context.data += expression.associationInfo.FromPropertyName + '/';\r\n    },\r\n    VisitEntityExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        this.Visit(expression.selector, context);\r\n    },\r\n    VisitMemberInfoExpression: function (expression, context) {\r\n        context.data += expression.memberName;\r\n    }\r\n});\r\n$C('$data.storageProviders.webApi.webApiPagingCompiler', $data.Expressions.EntityExpressionVisitor, null, {\r\n    constructor: function (provider) {\r\n        this.provider = provider;\r\n    },\r\n\r\n    compile: function (expression, context) {\r\n        this.Visit(expression, context);\r\n    },\r\n    VisitPagingExpression: function (expression, context) {\r\n        var pagingContext = { data: \"\" };\r\n        this.Visit(expression.amount, pagingContext);\r\n        switch (expression.nodeType) {\r\n            case $data.Expressions.ExpressionType.Skip: context['$skip'] = pagingContext.data; break;\r\n            case $data.Expressions.ExpressionType.Take: context['$top'] = pagingContext.data; break;\r\n            default: Guard.raise(\"Not supported nodeType\"); break;\r\n        }\r\n    },\r\n    VisitConstantExpression: function (expression, context) {\r\n        context.data += expression.value;\r\n    }\r\n});\r\n$C('$data.storageProviders.webApi.webApiProjectionCompiler', $data.Expressions.EntityExpressionVisitor, null, {\r\n    constructor: function (entityContext) {\r\n        this.entityContext = entityContext;\r\n        this.hasObjectLiteral = false;\r\n        this.ObjectLiteralPath = \"\";\r\n        this.modelBinderMapping = [];\r\n    },\r\n\r\n    compile: function (expression, context) {\r\n        this.Visit(expression, context);\r\n    },\r\n    VisitProjectionExpression: function (expression, context) {\r\n        ///<summary></summary>\r\n        ///<param name=\"expression\" type=\"$data.Expressions.ProjectionExpression\" mayBeNull=\"false\"></param>\r\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\r\n        context.data = \"\";\r\n        this.mapping = \"\";\r\n\r\n        this.Visit(expression.selector, context);\r\n        if (context['$select']) { context['$select'] += ','; } else { context['$select'] = ''; }\r\n        context[\"$select\"] += context.data;\r\n        context.data = \"\";\r\n    },\r\n    VisitParametricQueryExpression: function (expression, context) {\r\n        this.Visit(expression.expression, context);\r\n        if (expression.expression instanceof $data.Expressions.EntityExpression || expression.expression instanceof $data.Expressions.EntitySetExpression) {\r\n            if (context['$expand']) { context['$expand'] += ','; } else { context['$expand'] = ''; }\r\n            context['$expand'] += this.mapping.replace(/\\./g, '/')\r\n        } if (expression.expression instanceof $data.Expressions.ComplexTypeExpression) {\r\n            var m = this.mapping.split('.');\r\n            m.pop();\r\n            if (m.length > 0) {\r\n                if (context['$expand']) { context['$expand'] += ','; } else { context['$expand'] = ''; }\r\n                context['$expand'] += m.join('/');\r\n            }\r\n        } else {\r\n            var m = this.mapping.split('.');\r\n            m.pop();\r\n            if (m.length > 0) {\r\n                if (context['$expand']) { context['$expand'] += ','; } else { context['$expand'] = ''; }\r\n                context['$expand'] += m.join('/');\r\n            }\r\n        }\r\n    },\r\n    VisitObjectLiteralExpression: function (expression, context) {\r\n        ///<summary></summary>\r\n        ///<param name=\"expression\" type=\"$data.Expressions.ObjectLiteralExpression\" mayBeNull=\"false\"></param>\r\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\r\n        var tempObjectLiteralPath = this.ObjectLiteralPath;\r\n        this.hasObjectLiteral = true;\r\n        expression.members.forEach(function (member, index) {\r\n            this.Visit(member, context);\r\n            if (index < expression.members.length - 1) { context.data += ','; }\r\n            this.mapping = '';\r\n        }, this);\r\n        this.ObjectLiteralPath = tempObjectLiteralPath;\r\n    },\r\n    VisitObjectFieldExpression: function (expression, context) {\r\n\r\n\r\n        if (this.ObjectLiteralPath) { this.ObjectLiteralPath += '.' + expression.fieldName; } else { this.ObjectLiteralPath = expression.fieldName; }\r\n        this.Visit(expression.expression, context);\r\n\r\n        if (expression.expression instanceof $data.Expressions.EntityExpression || expression.expression instanceof $data.Expressions.EntitySetExpression) {\r\n            if (context['$expand']) { context['$expand'] += ','; } else { context['$expand'] = ''; }\r\n            context['$expand'] += this.mapping.replace(/\\./g, '/')\r\n        } else {\r\n            var m = this.mapping.split('.');\r\n            m.pop();\r\n            if (m.length > 0) {\r\n                if (context['$expand']) { context['$expand'] += ','; } else { context['$expand'] = ''; }\r\n                context['$expand'] += m.join('/');\r\n            }\r\n        }\r\n    },\r\n\r\n    VisitComplexTypeExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        this.Visit(expression.selector, context);\r\n    },\r\n\r\n    VisitEntityFieldExpression: function (expression, context) {\r\n        this.Visit(expression.source, context);\r\n        this.Visit(expression.selector, context);\r\n    },\r\n    VisitEntityExpression: function (expression, context) {\r\n        ///<summary></summary>\r\n        ///<param name=\"expression\" type=\"$data.Expressions.EntityExpression\" mayBeNull=\"false\"></param>\r\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\r\n        this.Visit(expression.source, context);\r\n    },\r\n    VisitEntitySetExpression: function (expression, context) {\r\n        ///<summary></summary>\r\n        ///<param name=\"expression\" type=\"$data.Expressions.EntitySetExpression\" mayBeNull=\"false\"></param>\r\n        ///<param name=\"context\" mayBeNull=\"false\"></param>\r\n        if (expression.source instanceof $data.Expressions.EntityExpression) {\r\n            this.Visit(expression.source, context);\r\n        }\r\n        if (expression.selector instanceof $data.Expressions.AssociationInfoExpression) {\r\n            this.Visit(expression.selector, context);\r\n        }\r\n    },\r\n    VisitAssociationInfoExpression: function (expression, context) {\r\n        if (context.data && context.data.length > 0 && context.data[context.data.length - 1] != ',') { context.data += '/'; }\r\n        context.data += expression.associationInfo.FromPropertyName;\r\n        if (this.mapping && this.mapping.length > 0) { this.mapping += '.'; }\r\n        this.mapping += expression.associationInfo.FromPropertyName;\r\n    },\r\n    VisitMemberInfoExpression: function (expression, context) {\r\n        if (context.data && context.data.length > 0 && context.data[context.data.length - 1] != ',') { context.data += '/'; }\r\n        context.data += expression.memberName;\r\n        if (this.mapping && this.mapping.length > 0) { this.mapping += '.'; }\r\n        this.mapping += expression.memberName;\r\n    },\r\n    VisitConstantExpression: function (expression, context) {\r\n        //Guard.raise(new Exception('Constant value is not supported in Projection.', 'Not supported!'));\r\n        //context.data += expression.value;\r\n        context.data = context.data.slice(0, context.data.length - 1);\r\n    }\r\n});\r\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _core = require('jaydata/core');\n\nvar _core2 = _interopRequireDefault(_core);\n\nvar _WebApiConverter = require('./WebApiConverter.js');\n\nvar _WebApiConverter2 = _interopRequireDefault(_WebApiConverter);\n\nvar _WebApiProvider = require('./WebApiProvider.js');\n\nvar _WebApiProvider2 = _interopRequireDefault(_WebApiProvider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _core2.default;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbXX0="],"sourceRoot":"/source/"}